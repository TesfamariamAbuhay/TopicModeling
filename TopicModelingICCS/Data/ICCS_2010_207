Procedia Computer
Science
Procedia
Computer
Science
00 (2010)
1‚Äì1047‚Äì56
Procedia
Computer
Science
1 (2012)

www.elsevier.com/locate/procedia

International Conference on Computational Science, ICCS 2010

Generative topographic mapping by deterministic annealing
Jong Youl Choia,b , Judy Qiua , Marlon Piercea , GeoÔ¨Ärey Foxa,b
a Pervasive

b School

Technology Institute, Indiana University, Bloomington IN, USA
of Informatics and Computing, Indiana University, Bloomington IN, USA

Abstract
Generative Topographic Mapping (GTM) is an important technique for dimension reduction which has been successfully applied to many Ô¨Åelds. However the usual Expectation-Maximization (EM) approach to GTM can easily get
stuck in local minima and so we introduce a Deterministic Annealing (DA) approach to GTM which is more robust
and less sensitive to initial conditions so we do not need to use many initial values to Ô¨Ånd good solutions. DA has been
very successful in clustering, hidden Markov Models and Multidimensional Scaling but typically uses a Ô¨Åxed cooling
schemes to control the temperature of the system. We propose a new cooling scheme which can adaptively adjust the
choice of temperature in the middle of process to Ô¨Ånd better solutions. Our experimental measurements suggest that
deterministic annealing improves the quality of GTM solutions.

c 2012 Published by Elsevier Ltd. Open access under CC BY-NC-ND license.
‚Éù

Keywords: deterministic annealing, Generative Topographic Mapping, nonlinear optimization
2010 MSC: 65K10, 65J15

1. Introduction
Visualization of high-dimensional data in a low-dimension space is the core of exploratory data analysis in which
users seek the most meaningful information hidden under the intrinsic complexity of data mostly due to high dimensionality. Among many tools available thanks to the recent advances in machine learning techniques and statistical
analysis, Generative Topographic Mapping (GTM) has been extensively studied and successfully used in many application areas: biology [1, 2], medicine [3, 4], feature selection [5], to name a few.
Generative Topographic Mapping (GTM) [6, 7] is an unsupervised learning method developed for modeling the
probability density of data and Ô¨Ånding a non-linear mapping of high-dimensional data onto a low-dimensional space.
Similar algorithms known for dimension reduction are Principle Component Analysis (PCA), Multidimensional Scaling (MDS) [8], and Self-Organizing Map (SOM) [9]. In contrast to the Self-Organizing Map (SOM) which does not
have any density model [7], GTM deÔ¨Ånes an explicit probability density model based on Gaussian distribution. For
this reason, GTM is also known as a principled alternative to SOM.
The problem challenged by the GTM is to Ô¨Ånd the best set of parameters associated with Gaussian mixtures
by using an optimization method, notably the Expectation-Maximization (EM) algorithm [6, 7]. Although the EM
algorithm [10] has been widely used in many optimization problems, it has been shown a severe limitation, known
Email addresses: jychoi@cs.indiana.edu (Jong Youl Choi), xqiu@indiana.edu (Judy Qiu), mpierce@cs.indiana.edu (Marlon
Pierce), gcf@cs.indiana.edu (GeoÔ¨Ärey Fox)

c 2012 Published by Elsevier Ltd. Open access under CC BY-NC-ND license.
1877-0509 ‚Éù
doi:10.1016/j.procs.2010.04.007

48

J.Y. Choi/ Procedia
et al. / Procedia
1 (2012) 47‚Äì56
ComputerComputer
Science 00Science
(2010) 1‚Äì10

2

xn
f

zk

/DWHQW 6SDFH / GLPHQVLRQ

yk

'DWD 6SDFH ' GLPHQVLRQ

Figure 1: Non-linear embedding by GTM

as a local optima problem [11], in which the EM method can be easily trapped in local optima failing to return
global optimum and so the outputs are very sensitive to initial conditions. To overcome such problem occurred in the
original GTM [6, 7], we have applied a robust optimization method known as Deterministic Annealing (DA) [12] to
seek global solutions, not local optima. Up to our best knowledge, this is the Ô¨Årst work to use DA algorithm to solve
the GTM problem in the literature.
The DA algorithm [12, 13, 14, 15] has been successfully applied to solve many optimization problems in various
machine learning algorithms and applied in many problems, such as clustering [16, 12, 17], visualization [18], protein
alignment [19], and so on. The core of the DA algorithm is to seek an global optimal solution in a deterministic
way [12], which contrasts to stochastic methods used in the simulated annealing [20], by controlling the level of
randomness. This process, adapted from a physical process, is known as annealing in that an optimal solution is
gradually revealing as lowering temperature which controls randomness. At each level of temperature , the DA
algorithm chooses an optimal solution by using the principle of maximum entropy [21], a rational approach to choose
the most unbiased and non-committal answers for given conditions.
Regarding the cooling process, which aÔ¨Äects the speed of convergency, in general it should be slow enough to
get the optimal solutions. Two types of Ô¨Åxed cooling schemes, exponential cooling schemes in which temperature
T is reduced exponentially such that T = Œ±T with a coeÔ¨Écient Œ± < 1 and linear scheme like T = T ‚àí Œ¥ for Œ¥ > 0,
are commonly used. Choosing the best cooling coeÔ¨Écient Œ± or Œ¥ is very problem dependent and no common rules
have been reported. Beside of those conventional schemes, in this paper we also present a new cooling scheme,
named adaptive cooling schedule, which can improve the performance of DA by dynamically computing the next
temperatures during the annealing process with no use of Ô¨Åxed and predeÔ¨Åned ones.
The main contributions of our paper are as follow:
i. Developing the DA-GTM algorithm which uses the DA algorithm to solve GTM problem. Our DA-GTM algorithm can give more robust answers than the original EM-based GTM algorithm, not suÔ¨Äering from the local
optima problem (Section 3).
ii. Deriving closed-form equations to predict phase transitions which is a characteristic behavior of DA [14]. Our
phase transition formula can give a guide to set the initial temperature of the DA-GTM algorithm (Section 4).
iii. Developing an adaptive cooling schedule scheme, in which the DA-GTM algorithm can automatically adjust the
cooling schedule of DA in an on-line manner. With this scheme, users are not required to set parameters related
with cooling schedule in DA (Section 5).
Our experiment results showing the performance of DA-GTM algorithm in real-life application will be shown in
Section 6 followed by our conclusion in Section 7.

J.Y. Choi et/ Procedia
al. / Procedia
Computer
1 (2012)
Computer
ScienceScience
00 (2010)
1‚Äì10 47‚Äì56

49
3

2. Overview of GTM
We start by brieÔ¨Çy reviewing the original GTM algorithm [6, 7]. The GTM algorithm is to Ô¨Ånd a non-linear
manifold embedding of K latent variables zk in low L-dimension space or latent space, such that zk ‚àà RL (k = 1, ..., K),
which can optimally represent the given N data points xn ‚àà RD (n = 1, ..., N) in the higher D-dimension space or data
space (usually L
D) (Figure 1). This is achieved by two steps: First, mapping the latent variables in the latent space
to the data space with respect to a non-linear mapping f : RL ‚Üí RD . Let us denote the mapped points in the data
space as yk . Secondly, estimating probability density between the mapped points yk and the data points xn by using
the Gaussian noise model in which the distribution is deÔ¨Åned as an isotropic Gaussian centered on yk having variance
Œ≤‚àí1 (Œ≤ is known as precision). More speciÔ¨Åcally, the probability density p(xn |yk ) is deÔ¨Åned by the following Gaussian
distribution:
N(xn |yk , Œ≤)

Œ≤
2œÄ

=

D/2

exp ‚àí

Œ≤
xn ‚àí yk
2

2

.

(1)

The choice of the non-linear mapping f : RL ‚Üí RD can be made from any parametric, non-linear model. In
the original GTM algorithm [6, 7], a generalized linear regression model has been used, in which the map is a linear
combination of a set of Ô¨Åxed M basis functions, such that,
yk = œÜTr
k W,

(2)

where a column vector œÜk = (œÜk1 , ..., œÜkM ) is a mapping of zk by the M basis function œÜm : RL ‚Üí R for m = 1, ..., M,
such that œÜkm = œÜm (zk ) and W is a M √ó D matrix containing weight parameters. ATr represents a transpose of matrix
A.
With this model setting, the objective of GTM algorithm corresponds to a Gaussian mixture problem to Ô¨Ånd an
optimal set of yk ‚Äôs which maximizes the following log-likelihood:
‚éß
‚é´
N
K
‚é™
‚é™
‚é™
‚é™
‚é®1
‚é¨
L(W, Œ≤) = argmax
ln ‚é™
p(xn |yk )‚é™
(3)
‚é™
‚é™
‚é©
‚é≠
K
W,Œ≤
n=1

k=1

It is the problem that Ô¨Ånding K centers for N data points, known as K-clustering problem. Since K-clustering
problem is NP-hard [22], the GTM algorithm uses the EM method which starts with initial random weight matrix W
and iteratively reÔ¨Ånes it to maximize Eq. (3), which can be easily trapped in local optima. More details can be found
in the original GTM paper [6, 7].
3. GTM with Deterministic Annealing (DA-GTM)

Since the use of EM, the original GTM algorithm suÔ¨Äers from the local optima problem in which the GTM map
can vary depending on the initial parameters. Instead of using the EM, we have applied the DA approach to Ô¨Ånd a
global optimum solution. With the help of DA algorithm, we can have more robust GTM maps against the random
initial value problem.
In fact, the GTM algorithm‚Äôs objective function (3) is exactly the same problem, so called K-clustering, discussed
by K. Rose in [12]. The problem is to seek optimal clusters for a given distance or distortion measurement by using
the deterministic annealing approach. Thus, we can use the same approach used in the Rose‚Äôs DA method. However,
in Rose‚Äôs paper, squared Euclidean distance has been used in distortion measurement but in the GTM algorithm,
distances are measured by the Gaussian probability as in Eq. (1). Thus, we need to redeÔ¨Åne distortion between two
points as d(xn , yk ) = ‚àí log p(xn |yk )/T , which leads us to the so-called partitioning function as follows:
K

Zn

exp

=
k=1

‚àíd(xn , yk )
.
T

(4)

In the DA algorithm, we have a new objective function, known as a free energy, which we want to minimize
through iterations. Now, by using the same deÔ¨Ånition of free energy, used in Rose‚Äôs paper in [12], we can drive a free

50

J.Y. Choi/ Procedia
et al. / Procedia
1 (2012) 47‚Äì56
ComputerComputer
Science 00Science
(2010) 1‚Äì10

4

energy function, for the DA-GTM algorithm as follows:
N

F(W, Œ≤, T ) =

ln Zn

argmin ‚àíT
W,Œ≤,T

(5)

n=1

‚éß
‚é™
‚é™
‚é® 1
= argmin ‚àíT
ln ‚é™
‚é™
‚é© K
W,Œ≤,T
n=1

1
T

N

K
k=1

‚é´
‚é™
‚é™
‚é¨
p(xn |yk ) ‚é™
‚é™
‚é≠
1
T

(6)

which we want to minimize as lowering temperature such that T ‚Üí 1.
Notice that the GTM algorithm‚Äôs objective function (3) diÔ¨Äers only the use of temperature T with our function
F(W, œÉ, T ). Especially, at T = 1, L(W, Œ≤) = ‚àíF(W, Œ≤, T ) and so the original GTM algorithm‚Äôs target function can be
considered as a special case of the DA-GTM algorithm‚Äôs.
To minimize (6), we need to make the following two partial derivatives be zero:
N

‚àÇF
‚àÇyk

= Œ≤

‚àÇF
‚àÇŒ≤

=

n=1

œÅkn (xn ‚àí yk )

K

N

(7)

D 1
‚àí xn ‚àí yk
2Œ≤ 2

œÅkn
n=1 k=1

2

(8)

where œÅkn is a property, known as responsibility, such that,
1

œÅkn

p(xn |yk ) T

=

K
k =1

(9)

1

p(xn |yk ) T

By using the same matrix notations used in the GTM paper [6, 7], the DA-GTM algorithm can be written as a
process to seek an optimal weights W and precision Œ≤ at each temperature T .
W

=

Œ≤ =

(Œ¶Tr G Œ¶)‚àí1 Œ¶Tr R X
1
ND

N
n

(10)

K
k

œÅkn xn ‚àí yk

2

where X is a N √óD data matrix, Œ¶ is a K√óM basis matrix, G is a K√óK diagonal matrix with elements gkk =

(11)
1
N
T
n (œÅkn )

.

4. Phase Transitions of DA-GTM
As a characteristic behavior of the DA algorithm explained by Rose in [12], it undergoes phase transitions as
lowering the temperatures. At some temperature, we can not obtain all solutions but, instead, we can only obtain
eÔ¨Äective number of solutions. All solutions will gradually pop out while the annealing process proceeds as with
lowering the temperature.
In the DA-GTM algorithm, we can observe the same behavior. As an extreme example, at very high temperature,
the DA-GTM algorithm gives only one eÔ¨Äective latent point in which all yk ‚Äôs are converged into the same point x¬Ø
N
xn /N. As lowering the temperature under a certain point, yk ‚Äôs
which is the center of data points, such that x¬Ø = n=1
settled in the same position start to ‚Äúexplode‚Äù. We call this temperature as the Ô¨Årst critical temperature, denoted by
T c . As we further lowering temperature, we can observe subsequent phase transitions and so existence of multiple
critical temperatures. Computing the Ô¨Årst phase transition is an important task since we should start our annealing
process with the initial temperature larger than T c .
In DA, we can deÔ¨Åne such phase transitions as a moment of loosing stability of the objective function, the free
energy F, and turning to be unstable. Mathematically, that moment corresponds to the point in which the Hessian of
the object function looses its positive deÔ¨Åniteness.

51
5

J.Y. Choi et/ Procedia
al. / Procedia
Computer
1 (2012)
Computer
ScienceScience
00 (2010)
1‚Äì10 47‚Äì56

For our DA-GTM algorithm, we can write the following Hessian matrix as a block matrix:
‚é°
‚é§
‚é¢‚é¢‚é¢ H11 ¬∑ ¬∑ ¬∑ H1K ‚é•‚é•‚é•
‚é¢‚é¢‚é¢ .
.. ‚é•‚é•‚é•‚é• ,
H = ‚é¢‚é¢‚é¢ ..
. ‚é•‚é•‚é•
‚é¢‚é£
‚é¶
HK1 ¬∑ ¬∑ ¬∑ HKK

(12)

where a sub matrix Hi j is a second derivative of the free energy F as shown in Eq. (6). More speciÔ¨Åcally, Hi j can be
written as follows:
Hkk
Hkk

=
=

‚àÇ2 F
=‚àí
‚àÇyk ‚àÇyTr
k
‚àÇ2 F
=
‚àÇyk ‚àÇyTr
k

N
n

N

Œ≤2
œÅkn (1 ‚àí œÅkn )(xn ‚àí yk )Tr (xn ‚àí yk ) ‚àí Œ≤œÅkn I D , or
T
Œ≤2
œÅkn œÅk n (xn ‚àí yk )Tr (xn ‚àí yk ) (k
T

n

k ),

(13)
(14)

where k, k = 1, . . . , K, and I D is an identity matrix of size D. Note that Hkk and Hkk are D √ó D matrices and thus,
H ‚àà RKD√óKD .
With the Hessian matrix above, we can compute the Ô¨Årst phase transition point occurred at T c . Assuming that the
system hasn‚Äôt undergone the Ô¨Årst phase transition and the current temperature is high enough, then we will have all
N
xn /N, and equal responsibilities as follows:
yk ‚Äôs settled in the center of the data point, denoted by y0 = x¬Ø = n=1
yk = y0 and œÅkn = 1/K

(15)

for all k = 1, ..., K. Then, the second derivatives can be rewritten by
Hkk

=

Hkk

=

Œ≤2 N
TK
ID
(K ‚àí 1)S x|y0 ‚àí
Œ≤
T K2
Œ≤2 N
S x|y0
T K2

(16)

‚àí

(17)

where S x|y0 represents a covariance matrix of centered data set such that,
S x|y0

=

1
N

N
n=1

and the Hessian matrix also can be rewritten by
‚éß‚é°
‚é™
‚é™
‚é¢ (K ‚àí 1)S x|y0
‚é™
2
‚é™‚é¢‚é¢‚é¢‚é¢
‚àíŒ≤ N ‚é™
‚é®
..
‚é¢‚é¢‚é¢
H =
‚é™
.
‚é¢‚é¢‚é£
‚é™
T K2 ‚é™
‚é™
‚é™
‚é©
‚àíS x|y0

(xn ‚àí y0 )Tr (xn ‚àí y0 )

¬∑¬∑¬∑
..
.
¬∑¬∑¬∑

‚àíS x|y0
..
.
(K ‚àí 1)S x|y0

(18)

‚é´
‚é§
‚é™
‚é™
‚é•‚é•‚é•
‚é™
‚é™
‚é™
‚é•‚é•‚é• T K
‚é¨
‚é•‚é•‚é• ‚àí
I KD ‚é™
‚é™
‚é™
‚é•‚é¶
Œ≤
‚é™
‚é™
‚é≠

(19)

The Ô¨Årst phase transition occurs when the system is getting unstable so that the above Hessian matrix is loosing
its positive deÔ¨Åniteness. I.e., the Ô¨Årst phase transition is the moment when the Hessian matrix becomes singular and
so its determinant equals 0(zero), such that det(H) = 0 at T = T c , which holds the following:
‚éõ‚é°
‚é§‚éû
‚àíS x|y0
‚éú‚éú‚éú‚é¢‚é¢‚é¢ (K ‚àí 1)S x|y0 ¬∑ ¬∑ ¬∑
‚é•‚é•‚é•‚éü‚éü‚éü
‚éú‚éú‚éú‚é¢‚é¢‚é¢
‚é•‚é•‚é•‚éü‚éü‚éü T c K
..
..
..
‚é•‚é•‚é•‚éü‚éü‚éü =
eig ‚éú‚éú‚éú‚é¢‚é¢‚é¢
(20)
.
.
.
‚éú‚éù‚é¢‚é£
‚é•‚é¶‚éü‚é†
Œ≤
¬∑ ¬∑ ¬∑ (K ‚àí 1)S x|y0
‚àíS x|y0

where eig( A) is an eigenvalue of A.
We can further simplify the above equation by using the Kronecker product:
‚éû
‚éõ‚é°
‚éõ‚é°
‚é§
‚àí1 ‚é•‚é•
‚àí1
‚éü‚éü‚éü
‚éú‚éú‚éú‚é¢‚é¢‚é¢ K ‚àí 1 ¬∑ ¬∑ ¬∑
‚éú‚éú‚éú‚é¢‚é¢‚é¢ K ‚àí 1 ¬∑ ¬∑ ¬∑
‚é•
‚éü‚éü‚éü‚éü
‚éú‚éú‚é¢‚é¢
‚éú‚éú‚éú‚éú‚é¢‚é¢‚é¢‚é¢
‚é•‚é•‚é•‚é•
..
..
..
..
..
..
eig ‚éú‚éú‚éú‚éú‚é¢‚é¢‚é¢‚é¢
=
eig
‚äó
S
‚éú‚éú‚éú‚é¢‚é¢‚é¢
‚é•‚é•‚é•
x|y0 ‚éü
.
.
.
.
.
.
‚éü‚é†‚éü
‚éù‚éú‚é£‚é¢
‚éù‚é£
‚é¶
‚àí1
¬∑¬∑¬∑ K ‚àí 1
‚àí1
¬∑¬∑¬∑ K ‚àí 1

‚é§‚éû
‚é•‚é•‚é•‚éü‚éü‚éü
‚é•‚é•‚é•‚é•‚éü‚éü‚éü‚éü
‚é•‚é•‚é•‚éü‚éü‚éü ‚äó eig S x|y0
‚é¶‚é†

(21)

52

J.Y. Choi/ Procedia
et al. / Procedia
1 (2012) 47‚Äì56
ComputerComputer
Science 00Science
(2010) 1‚Äì10

6

Since the Ô¨Årst critical temperature is the most largest one, we can use only the maximum eigenvalue among
multiple of them. Thus, the Ô¨Årst critical temperature can be obtained by the following equation:
Tc

=

(22)

Œ≤Œªmax

where Œªmax is the largest value of eig(S x|y0 ). Computing the subsequent critical temperature will be discuss in the next.
5. Adaptive cooling schedule
The DA algorithm has been applied in many areas and proved its success in Ô¨Ånding a global optimal solution
avoiding local minima. However, up to our knowledge, no literature has been found about the cooling schedule of
DA algorithm. Commonly used cooling schedule is exponential, such as T = Œ±T , or linear, such as T = T ‚àí Œ¥ for
some Ô¨Åxed coeÔ¨Écient Œ± and Œ¥. Those scheduling schemes are Ô¨Åxed in that cooling temperatures are pre-deÔ¨Åned and
the coeÔ¨Écient Œ± or Œ¥ will not be changed during the process, regardless of the complexity of a given problem.
However, as we discussed previously, the DA algorithm undergoes the phase transitions in which the solution
space can change dramatically. To avoid such drastic changes and make the transitions smoother, one may try to
use very small Œ± or Œ¥ coeÔ¨Écient. However, the procedure can go too long to be used in practice but still there is no
guarantee to produce global optimal solutions (You will see an example in our experiment result in the next).
To overcome such problem, we propose an adaptive cooling schedule in which next cooling temperatures are
determined dynamically during the annealing process. More speciÔ¨Åcally, at every iteration of DA algorithm, we
predict the next phase transition temperature and move to the point as quickly as possible.
General approach to Ô¨Ånd next critical temperatures T c at any given temperature T is the same as the previous
one in that we need to Ô¨Ånd T c to make det(H) = 0. However, in contrast to the method used in computing the Ô¨Årst
critical points, for this problem we can‚Äôt have any simpliÔ¨Åed closed-form equations in general. Instead, we can try to
divide the problem into pieces to derive closed-form equations and choose the best solution from multiple candidate
answers. This method could not provide an exact solution, compared to the method to solve the problem in a whole
set, but rather give us an approximation. However, our experiment has showed that such approximation can be a good
solution. Also, another advantage we can expect in using our adaptive cooling schedule is that users has no need to
set any coeÔ¨Écient for cooling schedule. Cooling process is automatically adjusted to the problem.
At a given state in GTM algorithm, we Ô¨Ånd K soft clusters in which each group is represented by yk . Instead of
Ô¨Ånding a global critical temperature from K clusters at once, we can Ô¨Ånd each critical temperature at each group and
choose one among K candidates which is the most largest yet lower than current temperature so that it can be used as
a next temperature.
The sketch of the algorithm is as follows: i) For each k cluster (k = 1, . . . , K), Ô¨Ånd a candidate of next critical
temperature T c,k which should satisfy det(Hkk ) = 0 as deÔ¨Åned in (13). ii) Choose the most largest yet lower than the
current T among {T c,k }.
To Ô¨Ånd det(Hkk ) = 0, we need to rewrite Eq. (13) as follows:
Hkk

=

T gkk
‚àíŒ≤2
ID
U x|yk ‚àí V x|yk ‚àí
T
Œ≤

(23)

with the following deÔ¨Ånition:
N

U x|yk

=
n=1

œÅkn (xn ‚àí yk )Tr (xn ‚àí yk )

(24)

(œÅkn )2 (xn ‚àí yk )Tr (xn ‚àí yk )

(25)

N

V x|yk

=
n=1

N
œÅkn . Then, the condition det(Hkk ) = 0 at T = T c,k will hold eig U x|yk ‚àí V x|yk =
and gkk = n=1
next critical temperature T c,k for the cluster k can computed by

T c,k

=

Œ≤
Œªmax,k
gkk

gkk
Œ≤ T c,k

and thus the

(26)

J.Y. Choi et/ Procedia
al. / Procedia
Computer
1 (2012)
Computer
ScienceScience
00 (2010)
1‚Äì10 47‚Äì56

Algorithm 1 GTM with Deterministic Annealing
DA-GTM
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:

Set T > T c by using Eq. (22)
Choose randomly M basis function œÜm (m = 1, ..., M)
Compute Œ¶ whose element œÜkm = œÜm (zk )
Initialize randomly W
Compute Œ≤ by Eq. (11)
while T ‚â• 1 do
Update W by Eq. (10)
Update Œ≤ by Eq. (11)
T ‚Üê NextCriticalTemp
end while
return Œ¶, W, Œ≤

53
7

Algorithm 2 Find the next critical temperature
NextCriticalTemp
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:

for k = 1 to K do
Œõk ‚Üê {‚àÖ}
for each Œª ‚àà eig U x|yk ‚àí V x|yk do
if Œª < T gkk /Œ≤ then
Œõk ‚Üê Œõ k ‚à™ Œª
end if
end for
Œªmax,k ‚Üê max(Œõk )
T c,k ‚Üê Œ≤Œªmax,k /gkk
end for
return T c ‚Üê max({T c,k })

where Œªmax,k is the largest but lower than T gkk /Œ≤ eigenvalue of the matrix U x|yk ‚àí V x|yk . The overall pseudo code is
shown in Algorithm 1 and Algorithm 2.
6. Experiment Results
To compare the performances of our DA-GTM algorithm with the original EM-based GTM (EM-GTM hereafter
for short), we have performed a set of experiments by using two datasets: i) the oil Ô¨Çow data used in the original GTM
paper [6, 7] obtained from the GTM website1 , which has 1,000 points having 12 dimensions for 3-phase clusters
and ii) chemical compound dataset obtained from PubChem database2 , which is a NIH-funded repository for over 60
million chemical molecules and provides their chemical structure Ô¨Ångerprints and biological activities, for the purpose
of chemical information mining and exploration. In this paper we have randomly selected 1,000 element subset having
166 dimensions.
First we have compared for the oil-Ô¨Çow data maximum log-likelihood produced by EM-GTM, DA-GTM with
exponential cooling scheme, and DA-GTM with adaptive cooling scheme and their GTM plots, known as ‚Äúposteriormean projection‚Äù plot [6, 7], in the latent space. For each algorithm, we have executed 10 runs with random setup,
chosen a median result, and drawn a GTM plot as shown in Figure 2. As a result, DA-GTM with adaptive cooling
scheme (c) has produced the largest maximum log-likelihood (best performance), while EM-GTM (a) produced the
smallest maximum log-likelihood (worst performance). Also, as seen in the Ô¨Ågures, a plot with larger maximum
log-likelihood shows better separation of the clusters.
In the next, we have compared the performance of EM-GTM and DA-GTM with 3 cooling schedule schemes:
i) Adaptive, which we have prosed in this paper, ii) Exponential with cooling coeÔ¨Écients Œ± = 0.95 (denoted Exp-A
hereafter), and iii) Exponential with cooling coeÔ¨Écients Œ± = 0.99 (denoted Exp-B hereafter). For each DA-GTM
setting, we have also applied 3 diÔ¨Äerent starting temperature 5, 6, and 7, which are all larger than the 1st critical
temperature which is about 4.64 computed by Eq. (22). Figure 3 shows the summary of our experiment results in
which numbers are estimated by the average of 50 executions with random initialization.
As a result shown in Figure 3, DA-GTM algorithm shows strong robustness against local minima since the mean of
log-likelihood from DA-GTM‚Äôs outperforms EM-GTM‚Äôs by about 11.15% even with smaller deviations. Interestingly,
at the starting temperature 7 and 9, the performance of Exp-B, which used more Ô¨Åner-grain cooling schedule (Œ± =
0.99) than Exp-A (Œ± = 0.95), is lower than Exp-A and even under EM-GTM. This shows that Ô¨Åne-grained cooling
schedule can not guarantee the best solution than corse-grained one in using DA. However, our adaptive cooling
scheme mostly outperforms among other cooling schemes. Figure 4 shows an example of execution of DA-GTM
algorithm with adaptive cooling schedule.
1 GTM

homepage, http://www.ncrg.aston.ac.uk/GTM/
project, http://pubchem.ncbi.nlm.nih.gov/

2 PubChem

54

J.Y. Choi/ Procedia
et al. / Procedia
1 (2012) 47‚Äì56
ComputerComputer
Science 00Science
(2010) 1‚Äì10

Maximum Log‚àíLikelihood = 1532.555

Maximum Log‚àíLikelihood = 1636.235

1.0

1.0

‚óè‚óè ‚óè
‚óè
‚óè ‚óè ‚óè
‚óè

Dim2

‚óè
‚óè ‚óè

‚óè

0.5
‚óè‚óè‚óè‚óè
‚óè
‚óè
‚óè

‚óè

‚óè

‚óè‚óè

‚óè

‚óè

‚óè
‚óè

0.0

‚óè
‚óè‚óè‚óè

‚óè‚óè ‚óè‚óè

‚óè

‚óè
‚óè ‚óè ‚óè‚óè

‚óè

Dim2

0.5

8

‚óè

‚óè
‚óè

0.0

‚óè

‚óè
‚óè
‚óè
‚óè
‚óè ‚óè‚óè

‚óè

‚óè

‚àí0.5

‚óè

‚óè
‚óè
‚óè
‚óè‚óè‚óè ‚óè‚óè
‚óè

‚óè
‚óè ‚óè
‚óè ‚óè
‚óè

‚àí0.5

‚óè

‚àí1.0

‚àí1.0
‚àí1.0

‚àí0.5

0.0

0.5

1.0

‚àí1.0

‚àí0.5

Dim1

0.0

0.5

1.0

Dim1

(a) EM-GTM

(b) DA-GTM with exp. scheme

Maximum Log‚àíLikelihood = 1721.554
1.0

‚óè
‚óè
‚óè

‚óè
‚óè

‚óè

0.5
‚óè

‚óè

‚óè

Dim2

‚óè
‚óè ‚óè
‚óè ‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè‚óè

‚óè

‚óè
‚óè

0.0
‚óè
‚óè

‚óè

‚óè
‚óè
‚óè
‚óè ‚óè
‚óè
‚óè

‚àí0.5

/DEHOV
$
%
‚àí1.0

&
‚àí1.0

‚àí0.5

0.0

0.5

1.0

Dim1

(c) DA-GTM with adaptive scheme
Figure 2: Comparison of (a) EM-GTM, (b) DA-GTM with exponential, and (c) DA-GTM with adaptive cooling scheme for the oil-Ô¨Çow data having
3-phase clusters(A=Homogeneous, B=Annular, and C=StratiÔ¨Åed conÔ¨Åguration). Plots are drawn by a median result among 10 random-initialized
executions for each scheme. As a result, DA-GTM (c) with adaptive cooling scheme has produced the largest maximum log-likelihood and the plot
shows better separation of the clusters, while EM-GTM (a) has output the smallest maximum log-likelihood and the plot shows many overlaps.

We have also compared EM-GTM and DA-GTM with exponential cooling scheme for the 1,000 element PubChem
dataset which has 166 dimensions. As shown in Figure 5, DA-GTM‚Äôs output is better than EM-GTM‚Äôs since DAGTM‚Äôs average maximum log-likelihood (-36,608) is larger than EM-GTM‚Äôs (-36,666).

55
9

/RJ√Ø/LNHOLKRRG OOK

J.Y. Choi et/ Procedia
al. / Procedia
Computer
1 (2012)
Computer
ScienceScience
00 (2010)
1‚Äì10 47‚Äì56

7\SH
(0
$GDSWLYH
([S√Ø$
([S√Ø%

1$

6WDUWLQJ 7HPSHUDWXUH

Figure 3: Comparison of EM-GTM with DA-GTM in various settings. Average of 50 random initialized runs are measured for EM-GTM, DA-GTM
with 3 cooling schemes (adaptive, exponential with Œ± = 0.95 (Exp-A) and Œ± = 0.99 (Exp-B).

‚óè

7\SH



6WDUWLQJ 7HPSHUDWXUH

7HPS

(YHUDJH /RJ /LNHOLKRRG
RI (0 *70



√Ø

7HPSHUDWXUH

/RJ√Ø/LNHOLKRRG YDOXH

‚óè

√Ø

‚óè

VW &ULWLFDO 7HPSHUDWXUH
‚óè

√Ø
7\SH
/LNHOLKRRG
√Ø







,WHUDWLRQ

(a) Progress of log-likelihood



,WHUDWLRQ

(b) Adaptive changes in cooling schedule

Figure 4: A progress of DA-GTM with adaptive cooling schedule. This example show how DA-GTM with adaptive cooling schedule progresses
through iterations

7. Conclusion
We have solved the GTM problem, originally using the EM method, by using the deterministic annealing (DA) algorithm which is more resilient against the local optima problem and less sensitive to initial conditions, from which the
original EM method was suÔ¨Äered. We have also developed a new cooling scheme, called adaptive cooling schedule.
In contrast to the conventional cooling schemes such as linear and exponential ones, all of them are pre-deÔ¨Åned and
Ô¨Åxed, our adaptive cooling scheme can adjust granularity of cooling speed in an on-line manner. In our experiment,
our adaptive cooling scheme can outperform other conventional methods.

56

J.Y. Choi
et al. / Procedia
1 (2012) 47‚Äì56
/ Procedia
ComputerComputer
Science 00Science
(2010) 1‚Äì10

Maximum Log‚àíLikelihood = ‚àí36584.455

Maximum Log‚àíLikelihood = ‚àí36456.181

1.0

1.0

‚óè

‚óè

‚óè

‚óè

‚óè

0.5

0.5

0.0
‚óè

‚óè
‚óè
‚óè

‚àí0.5

‚óè

‚óè

‚óè
‚óè

‚óè ‚óè
‚óè
‚óè
‚óè

‚óè

‚óè

‚óè

0.0
‚óè

‚óè ‚óè‚óè ‚óè‚óè

‚óè

‚óè ‚óè‚óè ‚óè
‚óè

‚óè

‚óè

Dim2

‚óè
‚óè
‚óè
‚óè ‚óè‚óè ‚óè ‚óè
‚óè‚óè
‚óè
‚óè‚óè

‚óè
‚óè ‚óè

Dim2

10

‚óè

‚óè
‚óè
‚óè
‚óè
‚óè
‚óè

‚óè
‚óè

‚óè

‚àí0.5

‚óè

‚óè
‚óè

‚óè

‚óè

‚óè

‚óè

‚àí1.0

‚àí1.0
‚àí1.0

‚àí0.5

0.0

Dim1

(a) EM-GTM

0.5

1.0

‚àí1.0

‚àí0.5

0.0

0.5

1.0

Dim1

(b) DA-GTM with exp. scheme

Figure 5: Comparison of (a) EM-GTM and (b) DA-GTM with exponential scheme for 1,000 element PubChem dataset having 166 dimensions.
Plots are drawn as a median result of 10 randomly initialized executions of EM-GTM and DA-GTM. The average maximum log-likelihood from
DA-GTM algorithm (-36,608) is larger than one from EM-GTM (-36,666).

References
[1] A. Staiano, L. De Vinco, A. Ciaramella, G. Raiconi, R. Tagliaferri, G. Longo, G. Miele, R. Amato, C. Del Mondo, C. Donalek, et al., Probabilistic principal surfaces for yeast gene microarray data-mining, in: Data Mining (ICDM 2004). Proceedings of Fourth IEEE International
Conference, 2004, pp. 202‚Äì208.
[2] D. D‚ÄôAlimonte, D. Lowe, I. Nabney, V. Mersinias, C. Smith, MILVA: An interactive tool for the exploration of multidimensional microarray
data (2005).
[3] A. Vellido, P. Lisboa, Handling outliers in brain tumour MRS data analysis through robust topographic mapping, Computers in Biology and
Medicine 36 (10) (2006) 1049‚Äì1063.
[4] D. Maniyar, I. Nabney, Visual data mining using principled projection algorithms and information visualization techniques, in: Proceedings
of the 12th ACM SIGKDD international conference on Knowledge discovery and data mining, ACM, 2006, p. 648.
[5] A. Vellido, Assessment of an Unsupervised Feature Selection Method for Generative Topographic Mapping, Lecture Notes in Computer
Science 4132 (2006) 361.
[6] C. Bishop, M. Svens¬¥en, C. Williams, GTM: The generative topographic mapping, Neural computation 10 (1) (1998) 215‚Äì234.
[7] C. Bishop, M. Svens¬¥en, C. Williams, GTM: A principled alternative to the self-organizing map, Advances in neural information processing
systems (1997) 354‚Äì360.
[8] J. Kruskal, Multidimensional scaling by optimizing goodness of Ô¨Åt to a nonmetric hypothesis, Psychometrika 29 (1) (1964) 1‚Äì27.
[9] T. Kohonen, The self-organizing map, Neurocomputing 21 (1-3) (1998) 1‚Äì6.
[10] A. Dempster, N. Laird, D. Rubin, Maximum likelihood from incomplete data via the EM algorithm, Journal of the Royal Statistical Society.
Series B (Methodological) 39 (1) (1977) 1‚Äì38.
[11] N. Ueda, R. Nakano, Deterministic annealing EM algorithm, Neural Networks 11 (2) (1998) 271‚Äì282.
[12] K. Rose, Deterministic annealing for clustering, compression, classiÔ¨Åcation, regression, and related optimization problems, Proceedings of
the IEEE 86 (11) (1998) 2210‚Äì2239.
[13] K. Rose, E. Gurewitz, G. Fox, A deterministic annealing approach to clustering, Pattern Recognition Letters 11 (9) (1990) 589‚Äì594.
[14] K. Rose, E. Gurewitz, G. Fox, Statistical mechanics and phase transitions in clustering, Physical Review Letters 65 (8) (1990) 945‚Äì948.
[15] K. Rose, E. Gurewitz, G. Fox, Vector quantization by deterministic annealing, IEEE Transactions on Information Theory 38 (4) (1992)
1249‚Äì1257.
[16] T. Hofmann, J. Buhmann, Pairwise data clustering by deterministic annealing, IEEE Transactions on Pattern Analysis and Machine Intelligence 19 (1) (1997) 1‚Äì14.
[17] X. Yang, Q. Song, Y. Wu, A robust deterministic annealing algorithm for data clustering, Data & Knowledge Engineering 62 (1) (2007)
84‚Äì100.
[18] H. Klock, J. Buhmann, Multidimensional scaling by deterministic annealing, Lecture Notes in Computer Science 1223 (1997) 245‚Äì260.
[19] L. Chen, T. Zhou, Y. Tang, Protein structure alignment by deterministic annealing, Bioinformatics 21 (1) (2005) 51‚Äì62.
[20] S. Kirkpatric, C. Gelatt, M. Vecchi, Optimization by simulated annealing, Science 220 (4598) (1983) 671‚Äì680.
[21] E. Jaynes, On the rationale of maximum-entropy methods, Proceedings of the IEEE 70 (9) (1982) 939‚Äì952.
[22] D. Aloise, A. Deshpande, P. Hansen, P. Popat, NP-hardness of Euclidean sum-of-squares clustering, Machine Learning 75 (2) (2009) 245‚Äì
248.

