Available online at www.sciencedirect.com

ScienceDirect
This space
is Computer
reservedScience
for the
Procedia
header, do not use it
Procedia
108C
(2017) 2328â€“2332
This space is reserved for the Procedia header, do not use it

International Conference on Computational Science, ICCS 2017, 12-14 June 2017,
Zurich, Switzerland

Stability Analysis of the Modiï¬ed IMPES Scheme for
Twoâ€“Phase
Flow inofPorous
Media IMPES
Including
Dynamic
Stability Analysis
the Modiï¬ed
Scheme
for
Twoâ€“Phase Flow Capillary
in Porous Pressure
Media Including Dynamic
Mohamed F. Pressure
El-Amin1,2âˆ—
Capillary
1

1

College of Engineering, Eï¬€at University, Jeddah 21478, Kingdom of Saudi Arabia
1,2âˆ—
2
Mohamed
F.ofEl-Amin
Mathematics Department,
Faculty
Science, Aswan University, Egypt
momousa@effatuniversity.edu.sa
College of Engineering, Eï¬€at University, Jeddah 21478, Kingdom of Saudi Arabia
2
Mathematics Department, Faculty of Science, Aswan University, Egypt
momousa@effatuniversity.edu.sa

Abstract
In this paper, the problem of two-phase ï¬‚ow in porous media including dynamic capillary
pressure has been studied numerically. The IMplicit Pressure Explicit Saturation (IMPES)
Abstract
scheme has been modiï¬ed to solve the governing equations. The pressure equation is treated
In this paper, the problem of two-phase ï¬‚ow in porous media including dynamic capillary
implicitly with the saturation equation to obtain the pressure, while the saturation equation
pressure has been studied numerically. The IMplicit Pressure Explicit Saturation (IMPES)
is solved explicitly to update the saturation at each time step. We introduce stability analysis
scheme has been modiï¬ed to solve the governing equations. The pressure equation is treated
of the modiï¬ed scheme and its stability condition has been derived. Comparison between the
implicitly with the saturation equation to obtain the pressure, while the saturation equation
static and the dynamic capillary pressure has been introduced to illustrate the eï¬ƒciency of the
is solved explicitly to update the saturation at each time step. We introduce stability analysis
modiï¬ed scheme.
of the modiï¬ed scheme and its stability condition has been derived. Comparison between the
Keywords:
ï¬‚ow,
Porous
media,
pressure,
IMPES, Stability
analysis.
static
the dynamic
capillary
pressure
has beencapillary
introduced
to illustrate
the eï¬ƒciency
of the
Â©
2017and
The Twoâ€“phase
Authors.
Published
by Elsevier
B.V.Dynamic
Peer-review
under responsibility of the scientific committee of the International Conference on Computational Science
modiï¬ed scheme.
Keywords: Twoâ€“phase ï¬‚ow, Porous media, Dynamic capillary pressure, IMPES, Stability analysis.

1

Introduction

All standard empirical relationships between capillary pressure and saturation (namely, the
1
static Introduction
capillary pressure) were correlated by laboratory experiments under equilibrium conditions. These formulas of the static capillary pressure (see e.g. [1, 14]) have been used in most of
All standard empirical relationships between capillary pressure and saturation (namely, the
the mathematical models of immiscible twoâ€“phase ï¬‚ows in porous media. However, it was found
static capillary pressure) were correlated by laboratory experiments under equilibrium condiexperimentally and theoretically that under nonâ€“equilibrium conditions the capillary pressure
tions. These formulas of the static capillary pressure (see e.g. [1, 14]) have been used in most of
does not correspond to the static capillary pressure. The dynamic capillary pressureâ€“saturation
the mathematical models of immiscible twoâ€“phase ï¬‚ows in porous media. However, it was found
relationship has been obtained in the framework of a macroscopic theory of porous media ï¬‚ow
experimentally and theoretically that under nonâ€“equilibrium conditions the capillary pressure
by Hassanizadeh and Gray [6]. Moreover, many experiments reported in the literature include
does not correspond to the static capillary pressure. The dynamic capillary pressureâ€“saturation
evidence of the dynamic eï¬€ect, such as Stauï¬€er [13]. So, using the static capillary pressurerelationship has been obtained in the framework of a macroscopic theory of porous media ï¬‚ow
saturation relationship when the ï¬‚uid content is in motion may be not suitable. An alternative
by Hassanizadeh and Gray [6]. Moreover, many experiments reported in the literature include
model of the capillary pressure-saturation relationship was proposed and referred to as dynamic
evidence of the dynamic eï¬€ect, such as Stauï¬€er [13]. So, using the static capillary pressurecapillary pressure is more suitable. When gradients of ï¬‚uids pressure and velocities are large,
saturation relationship when the ï¬‚uid content is in motion may be not suitable. An alternative
âˆ— Corresponding Author
model
of the capillary pressure-saturation relationship was proposed and referred to as dynamic
capillary pressure is more suitable. When gradients of ï¬‚uids pressure and velocities are large,
1
âˆ— Corresponding Author
1877-0509 Â© 2017 The Authors. Published by Elsevier B.V.
Peer-review under responsibility of the scientific committee of the International Conference on Computational Science
10.1016/j.procs.2017.05.150

1

	

Mohamed
F. El-Amin
Stability Analysis for an IMPES
Scheme
. . . et al. / Procedia Computer Science 108C (2017) 2328â€“2332
El-Amin and Sun

nonâ€“equilibrium eï¬€ects in the capillary pressure can be signiï¬cant. For instant, ï¬‚ow in some
industrial porous media, such as paper pulp drying process (Lewalle et al. [8]). Recently,
many experimental studies on the dynamics capillary pressure have been introduced [11, 10]. A
comprehensive review surveyed the experimental works in which nonâ€“equilibrium eï¬€ects have
been observed [5]. Moreover, other computational studies on dynamics capillary pressure using
Darcyâ€“scale models have been also introduced [9, 3]. In the case of twoâ€“phase ï¬‚ow in porous
media, the capillary pressure relationship under nonâ€“equilibrium conditions is determined using
future water saturation.
The model of two-phase ï¬‚uid ï¬‚ow in porous media is a coupled system of nonlinear timedependent partial diï¬€erential equations. The IMplicit Pressure Explicit Saturation (IMPES)
approach solves the pressure equation implicitly and updates the saturation explicitly. The
instability of the IMPES method results of the decoupling between the pressure equation and
the saturation equation as well as the explicit treatment of the capillary pressure [2]. Iterative
IMPES splits the equation system into an equation for pressure and another saturation equation
that are solved sequentially as IMPES [4]. A linear approximation of capillary function is
introduced to couple the implicit saturation equation into pressure equation [7]. In this work,
we modiï¬ed the IMPES scheme introduced in [7] to solve the ï¬‚ow equation of the model with
the dynamic capillary pressure.

2

Modeling and Mathematical Formulation

In this section, a mathematical model is developed to describe the two-phase ï¬‚ow in porous
media including the dynamic capillary pressure. Consider twoâ€“phase immiscible incompressible
ï¬‚ow in a porous medium which is governed by the Darcyâ€™s law and the equations of mass
conservation for each phase as,
âˆ‚ (Ï†SÎ± )
+ âˆ‡ Â· u Î± = qÎ± ,
âˆ‚t

uÎ± = âˆ’

krÎ±
Kâˆ‡pÎ± ,
Î¼Î±

Î± = w, n.

(1)

where SÎ± is the saturation, uÎ± is the velocity of the phase Î±. w stands for the wetting phase,
and n stands for the nonwetting phase. Ï† is the porosity of the medium, qÎ± is the external mass
ï¬‚ow rate. K is the absolute permeability tensor chosen as K = kI, I is the identity matrix
and k is a positive real number. krÎ± is the relative permeability, ÏÎ± is the density, and pÎ±
is the pressure, Î¼Î± is the viscosity of the phase Î±. The ï¬‚uid saturations for the wetting and
non-wetting are interrelated by, Sw + Sn = 1. Now, we describe the governing equations used
in [7] as,
âˆ’ âˆ‡ Â· Î»t Kâˆ‡pw âˆ’ âˆ‡ Â· Î»n Kâˆ‡pc = qw + qn .
(2)
and
âˆ‚ (Ï†SÎ± )
âˆ’ qw = âˆ’âˆ‡ Â· (fw ua ) .
âˆ‚t

(3)

where fw = Î»w /Î»t is the ï¬‚ow fraction, Î»Î± = krÎ± /Î¼Î± is the mobility.
The classical capillary pressureâ€“saturation relationship based on the thermodynamic equilibrium assumption, is commonly given as, pn âˆ’ pw = ps (Sw ). For non-equilibrium conditions,
the following equation for the ï¬‚uids pressure diï¬€erence has been suggested (Hassanizadeh and
Gray [6]),
âˆ‚Sw
pn âˆ’ pw = ps (Sw ) âˆ’ Ï„ (Sw )
.
(4)
âˆ‚t
2

2329

2330	

Mohamed
F. El-Amin
Stability Analysis for an IMPES
Scheme
. . . et al. / Procedia Computer Science 108C (2017) 2328â€“2332
El-Amin and Sun

where Ï„ is a non-equilibrium capillarity coeï¬ƒcient (material property) that may be a function
of saturation and other ï¬‚uidâ€“ï¬‚uid properties. The dynamic capillary pressure may be written
as,
âˆ‚Sw
pd (Sw , SÌ‡w ) = ps (Sw ) âˆ’ Ï„B (Sw ) pï¿½s
.
(5)
âˆ‚t

3

Solution Method

Deï¬ne the time step length Î”tn = tn+1 âˆ’ tn , the total time interval [0, T ] may be divided into
NT time steps as 0 = t0 < t1 < Â· Â· Â· < tNT = T . The current time step is represented by
the superscript n + 1, while the current time step is represented by the superscript n. The
backward Euler time discretization is used for the equation of saturation. The discretized
governing equations can be given as,
 n+1 
n
n
Aa (Sw
= Qn+1
) Pn+1
+ Ac (Sw
) Pd Sw
w
ac .

(6)

It is noted from above algebraic
equations
that the matrices Aa , Ac and Pd depend on the
 n n+1

is given by discretizing the approximation of capillary
, Sw
vector Sw . The vector Pd Sw
pressure, which may be rewritten in a matrix-vector form as follows,
n+1
n
 n n+1 
âˆ’ Sw
n
n Sw
= Ps (Sw
, Sw
) + Ï„B Pf (Sw
)
.
Pd S w
n
Î”t

(7)

where Ps depends on the vector Sw . Pf is resulted from the discretization of the pï¿½s and F that
n
n
n
) = diag (F (Sw
) Â· pï¿½s (Sw
)) , h = 1, 2, ..., Nc , Nc is the
is a diagonal matrix deï¬ned by, Pf (Sw
total number of all cells. In fact, the derivative of ps is a function of ps when the saturation at
each spatial point is varies with time. At the same time, the saturation is smoothly changing
along with time at each spatial point even if it is discontinuously distributed in space. Moreover,
the CCFD discretization of the saturation equation is,
M

âˆ’ Snw
Sn+1
w
n
+ Aw (Sw
) Pn+1
= Qn+1
w
w ,
Î”tn

(8)

where M is a diagonal matrix replaces the porosity. Substituting (7) and (8) into (6), one may
obtain the coupled pressure equation in the following form,




âˆ’1 n+1
(9)
= Qn+1
Qw
Aa âˆ’ Ï„B Ac Pf Mâˆ’1 Aw Pn+1
w
ac âˆ’ Ac Ps + Ï„B Pf M

The upwind scheme is used in the advection term of the saturation equation that used for
updating saturation. Thus,
M

4

 n n+1 
âˆ’ Snw
Sn+1
w
n
fw (Sw
+ As S w
, Pw
) = Qn+1
s
n
Î”t

(10)

Stability Analysis

The dynamic capillarity parameter Ï„B , has the main eï¬€ect on the stability of this scheme. In the
following analysis, the eï¬€ect of saturation error on the matrices Aw , Aa and Ac is neglected and
the capillary pressure is concentrated. Now we need to consider the propagation of numerical
errors from time step n to time step (n + 1). Local truncation error is not considered here.
 n = Sn + Î´Sn ,
For the nth step saturation Snw we denote for a perturbed saturation by S
w
w
w

3

	

Mohamed
F. El-Amin
Stability Analysis for an IMPES
Scheme
. . . et al. / Procedia Computer Science 108C (2017) 2328â€“2332
El-Amin and Sun

where Î´Snw represents the error for Snw . Similarly, we can obtain an inexact saturation at the
 n+1 = Sn+1 + Î´Sn+1 and Î´Sn+1 is the (n + 1)th step
(n + 1)th step that is expressed as S
w
w
w
w
 n ) âˆ’ Ps (Sn ) ï¿½ Pf (S
 n )Î´Sn , one may get,
saturation error. Moreover, since we have, Ps (S
w
w
w



w
âˆ’1
n
n
n+1
n
Ï„B
n


I + (1 âˆ’ Î”tn )Î”t HPf (Sw ) and I is the identity
Î´Sw ï¿½ CÎ´Sw , C = I âˆ’ Ï„B HPf (Sw )

matrix. Consequently, the scheme (I) is stable if the following condition holds, Ï (C) < 1,
Ï(C) is the spectral radius of the matrix C, i.e. all of the eigenvalues of this matrix must lie
within the unit circle in the complex plane. Theoretically, this condition is computable, but
practically it is too expensive to compute for guiding the choice of Î”tn . We assume that a
square domain is partitioned into one cell. As the results of the discretization of CCFD, all
the matrices M, Aw , Aa and Ac become positive scalar numbers and so is H. The stability
condition becomes,



Ï„B
n
n 
1 âˆ’ (1 âˆ’ Î”t
n )Î”t HBc /Sw 


< 1.
(11)

n 
1 + Ï„B HBc /Sw

Ï„B
This means that the scheme is stable for all Î”t
n â‰¥ 0.5. It is interesting to note that this scheme
n
is stable naturally because Ï„B >> Î”t , Ï„B is of order 105 âˆ’ 107 . For the case of the static
capillary pressure (Ï„B = 0), a small time step size is often required to attain the stability of
IMPES.

5

Results

Here we introduce an example to test the performance of the presented scheme. Consider the
capillary pressure formula, ps = âˆ’Bc log(S), Bc = 50 bar. The viscosities of water and oil
are 1 cP and 0.45 cP, respectively. The injection rate is 0.1 PV/year and we continue the
calculation until 0.5 PVI, with the time step, 0.01 day. The porosity is taken as 0.1 while the
permeability is 1 md. In this example, we run the simulation for the static Ï„B =0 and the
dynamic pressure, Ï„B >0. Fig. 1 (left) represents the water saturation proï¬les after 5 days of
injection for the two cases static and dynamic pressures. This ï¬gure shows that the saturation
in the case of dynamic capillary pressure is greater than the saturation in the case of static
capillary pressure. Moreover, comparison between static and dynamic capillary pressure are
plotted in Fig. 1 (right). Similarly, we may note that the dynamic capillary pressure is greater
than the static capillary pressure. These results are comparable to many experimental results
such as those in Fig. 5 in Ref. [12].

6

Conclusion

In the current work, we investigated the problem of two-phase ï¬‚ow in porous media including
the dynamic capillary pressure has been studied. The IMPES scheme is considered to solving
the problem under consideration. The saturation equation is used in two diï¬€erent locations
of the scheme. The ï¬rst location was when substituting the time derivative of the saturation
in the capillary pressure term in the pressure equation. In the second location, is the saturation equation which is explicitly with the upwinding advection to update the saturation. The
stability condition of the scheme has been determined. We conclude from this study that the
dynamic capillary pressure IMPES scheme is naturally stable.
4

2331

2332	

Mohamed
F. El-Amin
Stability Analysis for an IMPES
Scheme
. . . et al. / Procedia Computer Science 108C (2017) 2328â€“2332
El-Amin and Sun



"



!






 




 












	



















	

 

!

"




























Figure 1: (Left) saturation proï¬les after seven days of injection at the static and the dynamic
capillary pressures; (right) comparison between the static and the dynamic capillary pressures

References
[1] R.H. Brooks and A.T. Corey. Hydraulic properties of porous media. Hydrology, 1, 1964.
[2] K. H. Coats. Impes stability: selection of stable time steps. SPE-84924, SPE ReservoirSimulation
Symposium, Houston, TX., 2001.
[3] D. B. Das, M. Mirzaei, and N. Widdows. Nonâ€“uniqueness in capillary pressureâ€“saturationâ€“relative
permeability relationships for two-phase ï¬‚ow in porous media: interplay between intensity and
distribution of random microâ€“heterogeneities. Vadose Zone J., pages 6786â€“6803, 2006.
[4] M. F. El-Amin, J. Kou, and S. Sun. Convergence analysis of the nonlinear iterative method for
two-phase ï¬‚ow in porous media associated with nanoparticle injection. Int. J. Numer. Meth. Heat
Fluid Flow, page 1, 2017.
[5] S. M. Hassanizadeh, S. Celia, and H. Dahle. Dynamic eï¬€ects in the capillary pressuresaturation
relationship and their impacts on unsaturated ï¬‚ow. Vadose Zone J., pages 38â€“57, 2002.
[6] S. M. Hassanizadeh and W. G. Gray. Mechanics and thermodynamics of multiphase ï¬‚ow in porous
media including interphase boundaries. Adv. Water Res., 13:196â€“186, 1990.
[7] J. Kou and S. Sun. On iterative impes formulation for two phase ï¬‚ow with capillarity in heterogeneous porous media. Int. J. Numer. Anal. Model. Ser. B, 1(1):20â€“40, 2010.
[8] J. Lewalle, K. Singh, and J. Bambacht. Analysis of the wet pressing of paper pulp. Int. J.
Multiphase Flow, 20:415â€“437, 1994.
[9] S. Manthey, Hassanizadeh S. M., and R. Helmig. Macroâ€“scale dynamic eï¬€ects in homogeneous
and heterogeneous porous media. Trans. Porous Media, pages 121â€“145, 2005.
[10] D. M. Oâ€™Carroll, T. J. Phelan, and L. M. Abriola. Exploring dynamic eï¬€ects in capillary pressure
in multistep outï¬‚ow experiments. Water Res. Res., page W11419, 2005.
[11] O. Oung, S. M. Hassanizadeh, and A. Bezuijen. Two-phase ï¬‚ow experiments in a geocentrifuge
and the signiï¬cance of dynamic capillary pressure eï¬€ect. J. Porous Media, pages 247â€“257, 2005.
[12] G. C. Roach, D. M. Oâ€™Carroll, T. A. Newson, T. Sakaki, and T. H. Illangasekare. Experimental
investigation of dynamic eï¬€ects in capillary pressure: Grain size dependency and upscaling. Water
Resour. Res., page W08544, 2010.
[13] F. Stauï¬€er. Time dependence of the relations between capillary pressure, water content and conductivity during drainage of porous media. On Scale Eï¬€ects in Porous Media, IAHR, Thessaloniki,
Greece, 1978.
[14] M. T. van Genuchten. A closed-form equation for predicting the hydraulic conductivity of unsaturated soils. Soil Sc. Soc. Amer. J., 44:892â€“898, 1980.

5

