Available online at www.sciencedirect.com

ScienceDirect
Procedia Computer Science 108C (2017) 1873â€“1882

International Conference on Computational Science, ICCS 2017, 12-14 June 2017,
Zurich,
SwitzerlandModel Analysis of an
Reduced Fracture Finite
Element

Efficient Fracture
Two-Scale
Hybrid
Embedded
Reduced
Finite
Element
ModelFracture
AnalysisModel
of an
Efficient Two-Scale Hybrid
Embedded
Fracture
Model
1*
2â€ 
3â€¡
1,3

Sahar Z. Amir , Huangxin Chen , Shuyu Sun

King Abdullah University of Science and Technology (KAUST), Computational Transport
1*
2â€ 
3â€¡
Z. Amir
Huangxin
Chen
, Shuyu Sun
Phenomena Sahar
Laboratory
(CTPL),,Physical
Science
and Engineering
Division (PSE).
1,3
King Abdullah University Thuwal,
of Science
and Technology
23955-6900,
Saudi (KAUST),
Arabia. Computational Transport
2
Phenomena
Laboratory
Physical Science
Engineering
Division
(PSE). on
Xiamen
University,
School(CTPL),
of Mathematical
Sciences,and
Fujian
Provincial
Key Laboratory
Thuwal,
23955-6900,
SaudiComputing,
Arabia.
Mathematical Modeling and High
Performance
Scientific
Fujian, 361005, China
2
Xiamen University, School of Mathematical Sciences, Fujian Provincial Key Laboratory on
Mathematical Modeling and High Performance Scientific Computing, Fujian, 361005, China
Abstract
A Hybrid Embedded Fracture (HEF) model was developed to reduce various computational costs
Abstract
while maintaining physical accuracy (Amir and Sun, 2016). HEF splits the computations into fine
A
Hybrid
Embedded
(HEF)
was developed
to reduce various
computational
costs
scale
and coarse
scale.Fracture
Fine scale
solvesmodel
analytically
for the matrix-fracture
flux exchange
parameter.
while
maintaining
physical
accuracy
(Amir
and
Sun,
2016).
HEF
splits
the
computations
into
Coarse scale solves for the properties of the entire system. In literature, fractures were assumed tofine
be
scale
coarse
Finefor
scale
solves analytically
matrix-fracture
flux exchange
either and
vertical
or scale.
horizontal
simplification
(Warrenfor
andthe
Root,
1963). Matrix-fracture
fluxparameter.
exchange
Coarse
scalewas
solves
for few
the properties
the entire
system.
In literature,
fractures
wereLemonnier
assumed toand
be
parameter
given
equationsofbuilt
on that
assumption
(Kazemi,
1968;
either
vertical
or horizontal
forsuch
simplification
Matrix-fracture
flux exchange
Bourbiaux,
2010).
However,
simplified (Warren
cases doand
notRoot,
apply1963).
directly
for actual random
fracture
parameter
was given
few equations
built
on shows
that assumption
and
shapes, directions,
orientations
â€¦etc. This
paper
that the HEF(Kazemi,
fine scale 1968;
analyticLemonnier
solution (Amir
Bourbiaux,
2010).
However,
simplifiedparameter
cases do not
apply
directly for
fracture
and Sun, 2016)
generates
the such
flux exchange
found
in literature
for actual
verticalrandom
and horizontal
shapes, directions,
â€¦etc.
This
thatparameter
the HEF fine
scale according
analytic solution
fracture
cases. For orientations
other fracture
cases,
thepaper
flux shows
exchange
changes
to the (Amir
angle,
and
2016) â€¦
generates
flux exchange
parameter
found in
for vertical
and horizontal
slop,Sun,
direction,
etc. Thisthe
conclusion
rises from
the analysis
of literature
both: the Discrete
Fracture
Network
fracture
cases.
fracture
the flux
exchange
parameter
changes
according
to thefracture
angle,
(DFN) and
the For
HEFother
schemes.
Thecases,
behavior
of both
schemes
is analyzed
with exactly
similar
slop,
direction,
â€¦ results
etc. This
from the
analysis
of both: theisDiscrete
Fracture
conditions
and the
areconclusion
shown andrises
discussed.
Then,
a generalization
illustrated
for anyNetwork
slightly
(DFN)
and thesingle-phase
HEF schemes.
behavior
of both
schemes
analyzed
with
similar fracture
compressible
fluidThe
within
fractured
porous
mediaisand
its results
areexactly
discussed.
conditions and the results are shown and discussed. Then, a generalization is illustrated for any slightly
Â© 2017 The Authors. Published by Elsevier B.V.
compressible
single-phase
fluid within
fractured
porous
media
andmatrix-fracture
its results areflux
discussed.
Keywords: Discrete
Fracture Network
(DFN),
two-scale,
hybrid
method,
exchange.
Peer-review under responsibility of the scientific committee of the International Conference on Computational Science
Keywords: Discrete Fracture Network (DFN), two-scale, hybrid method, matrix-fracture flux exchange.

1 Introduction
fluids including oil, gas, or combinations of both are usually trapped within rock
Introduction
1 Hydrocarbon
formations. Rock formation properties include their bulk and void spaces. Such properties need to be
Hydrocarbon fluids including oil, gas, or combinations of both are usually trapped within rock
formations.
Rock formation properties include their bulk and void spaces. Such properties need to be
*
Sahar Zishan Ahmed Amir: sahar.amir@kaust.edu.sa; sahar.amir.2017@gmail.com
Huangxin Chen: chx@xmu.edu.cn
Shuyu Sun: shuyu.sun@kaust.edu.sa; shuyusun@gmail.com
Sahar Zishan Ahmed Amir: sahar.amir@kaust.edu.sa; sahar.amir.2017@gmail.com
â€ 
â€ 
Huangxin Chen: chx@xmu.edu.cn
â€¡
â€¡
Shuyu Sun: shuyu.sun@kaust.edu.sa; shuyusun@gmail.com
â€ 
â€¡
*
*

1877-0509 Â© 2017 The Authors. Published by Elsevier B.V.
Peer-review under responsibility of the scientific committee of the International Conference on Computational Science
10.1016/j.procs.2017.05.052

1874	

Sahar Z. Amir et al. / Procedia Computer Science 108C (2017) 1873â€“1882

comprehended to estimate the hydrocarbon fluids production rates. Different mechanisms are used to
obtain them such as CT scans (Schlumberger, 2013). Such mechanisms work well but depend
considerably on many aspects that include: (1) Observation scales: dealing with whole-core sections
differs significantly from dealing with many cross-sectional slices from tomography CT scanners. (2)
Internal heterogeneities: appear at several scales affecting various properties (Weber, 1986). Such
heterogeneities are affected by naturally existing fractures and hydraulic fractures. (3) Representative
nature of images used: depend on the scale selected to analyze rock samples.
Since fractures affect internal heterogeneities and flow behaviors significantly, they need to be
considered when studying flows through rocks (porous mediums). Many numerical approaches were
developed over the years to deal with fractured systems: (1) Single-Continuum (SC) models: designate
both matrices and fractures explicitly within grid cells by their positions, permeabilities, porosities,
and mesh sizes (Civan et al., 2011). (2) Dual-Continuum (DC) models: deal with two disconnected
overlapping continua: fractures and matrices. Fractures act as major flow routes and matrices serve as
main storage. Interaction between both continua is synchronized by a flux exchange parameter
(Warren and Root, 1963; Li et al., 2014; Clarkson et al., 2012). (3) Discrete Fracture Network (DFN)
models: require significant CPU time even for a single well simulation making it neither practical nor
beneficial to use, particularly in dense fractured systems (Cipolla et al., 2010; Zhang et al., 2009). (4)
Hybrid Finite Volume (HFV) models: homogenize short to medium size fractures as part of the
continuum described by permeability and porosity and deals with large fractures using DFN as a
hierarchy (Li et al., 2008). (5) Enhanced matrix permeabilities considering medium size fractures and
modeling large fractures explicitly as major fluid conductors (Lee et at., 2000; Lee et al., 2001) in Cell
Centered Finite Difference (CCFD) scheme. This paper deals with this predicament by applying an
iterative Hybrid Embedded multiscale (two-scale) Fracture (HEF) model introduced in details by
Amir and Sun (2016). HEF splits the system computations into fine scale and coarse scale. Fine scale
solves analytically for the matrix-fracture flux exchange parameter within each grid cell. This allows
detailed control over fractures properties including their shapes, sizes, orientations â€¦ etc. Coarse scale
solves for the matrix-fractures pressures of the entire system using the resulting flux exchange
parameter [matrix in D dimensions and fractures in (D-1) dimensions].
In literature, fractures were assumed to be either vertical or horizontal for simplification (Warren
and Root, 1963). Matrix-fracture flux exchange parameter was given few equations built on that
assumption (Kazemi, 1968; Lemonnier and Bourbiaux, 2010). However, such simplified cases do not
apply directly for actual random fracture shapes, directions, orientations â€¦etc. This paper shows that
the HEF fine scale analytic solution (Amir and Sun, 2016) fits perfectly with the flux exchange
parameter found in literature for vertical and horizontal fracture cases. For other fracture cases, the
flux exchange parameter changes according to the angle, slop, direction, â€¦ etc. This conclusion rises
from this paper analysis of both: the Reduced Fractures (RF) finite element method scheme (Jaffre et
al., 2006) and the HEF scheme. The behavior of both schemes is analyzed with exactly similar fracture
conditions and the results are shown and discussed. Also, the shale gas model from Amir and Sun
(2016) that applies to laboratory test conditions is generalized to any slightly compressible singlephase fluid within the fractured porous media. Generalization concept, governing equations, flow
behaviors, results are illustrated and discussed.

2 Flux exchange parameter
In general, flux exchange parameters couple: pressure gradients within matrix blocks, fractures and
surrounding matrices interactions, viscous force effects, capillary pressures, gravity effects,
components molecular diffusion rates, â€¦ etc. Several techniques can be used to define the
dimensionless flux exchange parameter shape factor ğ›¼ğ›¼ âˆ— that reflects somewhat physically accurate
estimations. Such approaches include: analytic solutions, DFN models approximations for fracture

	

Sahar Z. Amir et al. / Procedia Computer Science 108C (2017) 1873â€“1882

defined boundary value problems, thermodynamic properties gained by molecular simulations, â€¦ etc.
Although it is not necessary for all of these approaches to give exactly similar results since they might
depend on different scales, number of inputs and outputs considered, assumed simplification, â€¦ etc.
but their behavior need to be relatively similar to maintain the physical effects of the matrix-fracture
flux exchange.
For simplification purposes in this section, the DFN scheme application to a RF model (RF-DFN)
for an incompressible single-phase flow is used as base of comparison. The adjacency of ğ›¼ğ›¼ âˆ— numerical
solution using this approach is compared to the simplified analytical solutions introduced in Amir and
Sun (2016) for the HEF scheme application to a RF model (RF- HEF). Results show that the RF-HEF
model ğ›¼ğ›¼ âˆ— fits perfectly with the simplified vertical and horizontal fractures case results (Warren and
Root, 1963; Kazemi, 1968; Lemonnier and Bourbiaux, 2010). For different fracture shapes cases, ğ›¼ğ›¼ âˆ—
changes according to angles, slops, directions, â€¦ etc. Focusing on the slop effect, ğ›¼ğ›¼ âˆ— adjacency in
both schemes is compared for exactly similar fractures conditions and the results are illustrated and
discussed within this section.

2.1 Analysis assumptions and equations
Focusing on a fine-scale that allows modeling each fracture individually within a grid cell. At such
scale, fracture shapes are defined using their ğ‘¥ğ‘¥, ğ‘¦ğ‘¦ positions in 2D planes and their ğ‘¥ğ‘¥, ğ‘¦ğ‘¦, ğ‘§ğ‘§ positions in
3D planes. To simplify the concept grasping, we focus on the analysis in 2D and the RF-DFN model
for an incompressible single-phase flow comparison to the fine-scale in the RF-HEF model. RF
assumptions ignore fractures apertures and deal with them as interfaces. Fractures apertures effects are
included within permeability and porosity for each type of rock fabric within each cell. RF-DFN
model solves for fractures as interfaces between the matrices as a system using the equations listed in
Table 1. Further discretization details of the RF-DFN model, used in this paper, are illustrated in Chen
and Sun (2016). Existence, uniqueness, and error estimation assumptions are explained in Jaffre et al.
(2006). The RF-DFN model used in this paper utilizes the Raviart-Thomas mixed finite element
approximation of order 1 (ğ‘…ğ‘…ğ‘‡ğ‘‡! ) to solve for the flux exchange parameter numerically.
Matrices system
âˆ‡! . ğ‘¢ğ‘¢! = ğ‘ğ‘!
in Î©!
ğ‘¢ğ‘¢! = âˆ’ğ¾ğ¾! âˆ‡ğ‘ğ‘! in Î©!
Matrix Boundary Conditions (B.C.):
ğ‘ğ‘! = ğ‘ğ‘!"#"
on Î“i (Dirichlet B.C.)
(on the fracture)
ğ‘ğ‘! = ğ‘ğ‘!

Fractures system
âˆ‡! . ğ‘¢ğ‘¢! = ğ‘ğ‘! + (ğ‘¢ğ‘¢! . ğ‘›ğ‘› âˆ’ ğ‘¢ğ‘¢! . ğ‘›ğ‘›) on ğ‘“ğ‘“
ğ‘¢ğ‘¢! = âˆ’ğ‘‘ğ‘‘ ğ‘˜ğ‘˜! âˆ‡! ğ‘ğ‘!
on ğ‘“ğ‘“
Fracture Boundary Conditions (B.C.):
ğ‘ğ‘! = ğ‘ğ‘!!
on âˆ‚ğ‘“ğ‘“
ğ‘‘ğ‘‘ is fracture thickness.

Table 1: The equations used for the fractures and matrices system in the DFN comparison base

The assumed fracture shapes in geometry define the RF-DFN unstructured grid cells generated for
the solution such that fractures form interfaces between matrix blocks where they exist as illustrated in
Figs. 1-4. Fig. 1 illustrates an example for elements generation according to the fractures in RF-DFN
model. Connecting any three purple dots form the discretization elements. Fractures are located at
matrix grid cells interfaces as demonstrated by the green line. Figs. 2-4 show that different fracture
shapes results in different elements distributions. Also, the flow behavior in such grid cells shows
lower pressure values at the fractures that almost reach zero in most cases and varies gradually as we
go further from the fractures.
On the other hand, the fine scale in RF-HEF model is built on assuming that fractures have zero
pressure values: ğ‘ƒğ‘ƒ! = 0. Since pressures need to increase gradually as we go further from the
fractures, the RF-HEF fine scale analytical solutions are built on assuming linear matrix pressure
functions ğ‘ƒğ‘ƒ!! (ğ‘‘ğ‘‘) that are defined by the vertical distances ğ‘‘ğ‘‘! between fractures and coarse grid cell
edges within each cell. In other words, ğ‘ƒğ‘ƒ!! ğ‘‘ğ‘‘ : ğ¸ğ¸ â†’ â„; âˆ‡ğ‘ƒğ‘ƒ!! âŠ¥ Fracture ğ›¾ğ›¾ . As a result, matrix

1875

1876	

Sahar Z. Amir et al. / Procedia Computer Science 108C (2017) 1873â€“1882

pressures at the points aligned with the fracture are zero since the distance from the fracture ğ‘‘ğ‘‘ is zero:
ğ‘ƒğ‘ƒ!! (0) = 0; since all pressures in porous media are always positive according to the physical laws and
distances from fractures are always positive, we can write: ğ‘ƒğ‘ƒ!! â‰¥ 0; and the absolute matrix partial
derivatives sum up to 1: âˆ‡ğ‘ƒğ‘ƒ!! = 1. The theoretical derivation for the assumptions considering several
possible fracture shapes within each grid cell was illustrated in Amir and Sun (2016).

Figure 1: example for DFN elements generated by
connecting any three purple dots and fracture
interfaces specifications.

Figure 3: fracture forms a vertical line that appears
clearly within the pressures distribution.

Figure 2: fracture form a line with slop ğ’ğ’ = ğŸğŸ that
appears clearly within the pressures distribution.

Figure 4: fracture form a line with slop ğ’ğ’ = ğŸğŸ. ğŸ•ğŸ•ğŸ•ğŸ•
that appears clearly within the pressures distribution.

Since fracture shapes are defined using their ğ‘¥ğ‘¥, ğ‘¦ğ‘¦ positions within each 2D grid cell, a normalized
grid cell needs to be determined for the RF-DFN and RF-HEF analysis. In other words, if the size of
the normalized grid cell was chosen to be ğ‘ğ‘, then the normalized grid cell ranges between 0: ğ‘ğ‘ Ã—
[0: ğ‘ğ‘]. As a result, all the fractures defined by their ğ‘¥ğ‘¥, ğ‘¦ğ‘¦ positions in any grid cell need to be scaled to
fit in that normalized grid cell while preserving their shape, orientation, size, â€¦ etc.
Each fracture at the normalized cell will intersect with the grid cell edges at two points: ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦!
and ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! . For triangle shape fractures, this could look like Fig.5 original shape part or itâ€™s mirrored
shape. Amir and Sun (2016) shape factors were built on Fig.6 assumption for the triangle shape
fractures such that fractures intersect with the grid cell edges at the two points: ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! and ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! .
For such fracture shape cases, Amir and Sun (2016) derivation can be applied directly from Table 2.
However, if the fractures original shape took Fig.5 shape, then the symmetrical properties are applied.
Symmetrical properties indicate that the behavior at one corner of the grid cell can be mirrored to the
other corner. However, the mirroring effect needs to be applied correctly and the new resulting
coordinates need to be used carefully in the analytic solutions to correspond to numerical solutions.
Applying the symmetrical mirroring effects to the triangle shape fractures, we end up with Equs. (1-2).

	

Sahar Z. Amir et al. / Procedia Computer Science 108C (2017) 1873â€“1882

Figure 5: due to symmetry, original shapes can be
mirrored easily and the new resulting coordinates are used if
needed in the analytic solutions to correctly correspond to
numerical solutions.

Figure 6: the analytic solution based on the
indexes illustrated in this figure (Amir and Sun,
2016).

Fracture Shape
Triangle shape
fractures

Distance ğ’…ğ’…ğ’Šğ’Š
ğ‘‘ğ‘‘! = ((ğ‘¦ğ‘¦! âˆ’ ğ‘¦ğ‘¦! )(ğ‘¥ğ‘¥! âˆ’ ğ‘¥ğ‘¥! )) ğ›¾ğ›¾
If both fracture points are on grid cell corners.
ğ‘‘ğ‘‘! = 1 ğ›¾ğ›¾ âˆ— ğ‘¦ğ‘¦! âˆ’ ğ‘¦ğ‘¦! ğ‘¥ğ‘¥ âˆ’ ğ‘¥ğ‘¥! âˆ’ ğ‘¥ğ‘¥! âˆ’ ğ‘¥ğ‘¥! ğ‘¦ğ‘¦ âˆ’ ğ‘¦ğ‘¦!
If one fracture point is on a grid cell corner and the other
is on a grid cell edge.

Vertical shape
fractures

One side:
ğ‘‘ğ‘‘! = âˆ†ğ‘¥ğ‘¥! .
Both sides:
ğ‘‘ğ‘‘!" = (âˆ†ğ‘¥ğ‘¥! + âˆ†ğ‘¥ğ‘¥! ) 2.

Horizontal
shape fractures

Vertical
Tetragonal
shape fractures

One side:
ğ‘‘ğ‘‘! = âˆ†ğ‘¦ğ‘¦! .
Both sides:
ğ‘‘ğ‘‘!" = (âˆ†ğ‘¦ğ‘¦! + âˆ†ğ‘¦ğ‘¦! ) 2.

1877

ğ‘‘ğ‘‘! = (ğ‘¥ğ‘¥! âˆ’ ğ‘¥ğ‘¥! ) âˆ— (ğ‘¦ğ‘¦! âˆ’ ğ‘¦ğ‘¦! )
ğ›¾ğ›¾
If selected distances forms a triangle with both fracture
points on the grid cell corners.
ğ‘‘ğ‘‘! = 1 ğ›¾ğ›¾ âˆ— ğ‘¦ğ‘¦! âˆ’ ğ‘¦ğ‘¦! ğ‘¥ğ‘¥ âˆ’ ğ‘¥ğ‘¥! âˆ’ ğ‘¥ğ‘¥! âˆ’ ğ‘¥ğ‘¥! ğ‘¦ğ‘¦ âˆ’ ğ‘¦ğ‘¦!
If selected distances forms a triangle with one fracture
point on a grid cell corner and the other on a grid cell
edge.
ğ‘‘ğ‘‘! = ğ‘¦ğ‘¦ âˆ’ ğ‘¦ğ‘¦! ! + ğ‘¥ğ‘¥ âˆ’ ğ‘¥ğ‘¥! ! â†’ General case. Since
ğ‘ğ‘ ! = (ğ‘¥ğ‘¥ ! + ğ‘¦ğ‘¦ ! ) âˆ’ ğ‘¥ğ‘¥! + ğ‘¥ğ‘¥! ğ‘¥ğ‘¥ âˆ’ 2ğ‘¦ğ‘¦! ğ‘¦ğ‘¦ + ğ‘¥ğ‘¥! ğ‘¥ğ‘¥! +
ğ‘¦ğ‘¦!! = 0; ğ‘‘ğ‘‘! = ğ‘ğ‘ ! (Not linear).

ğœ¶ğœ¶âˆ—

One side:
!
ğ›¼ğ›¼ âˆ— = â„ ğ‘‘ğ‘‘!"#
Both sides:
!
ğ›¼ğ›¼ âˆ— = 2â„ ğ‘‘ğ‘‘!"#

One side:
!
ğ›¼ğ›¼ âˆ— = 2â„ ğ›¾ğ›¾ ğ‘‘ğ‘‘!"#
Both sides:
!"
ğ›¼ğ›¼ âˆ— = 4â„ ğ›¾ğ›¾ ğ‘‘ğ‘‘!"#
One side:
!
ğ›¼ğ›¼ âˆ— = 2â„ ğ›¾ğ›¾ ğ‘‘ğ‘‘!"#
Both sides:
!"
ğ›¼ğ›¼ âˆ— = 4â„ ğ›¾ğ›¾ ğ‘‘ğ‘‘!"#
One side:
!
ğ›¼ğ›¼ âˆ— = â„ ğ‘‘ğ‘‘!"#
Both sides:
!
ğ›¼ğ›¼ âˆ— = 2â„ ğ‘‘ğ‘‘!"#

Table 2: RF-HEF fine scale ğœ¶ğœ¶âˆ— equations from Amir and Sun (2016). One side indicates considering the
distances from one side of the fracture. Two sides indicate considering the distances from both side of the fracture

If fracture corners are on grid cell corners:
One corner on grid cell corner and the other
on a grid cell edge:

ğ‘‘ğ‘‘! = ((ğ‘¦ğ‘¦! + ğ‘¦ğ‘¦! )(ğ‘¥ğ‘¥! âˆ’ ğ‘¥ğ‘¥! )) ğ›¾ğ›¾
ğ‘‘ğ‘‘! = 1 ğ›¾ğ›¾ âˆ— ğ‘¦ğ‘¦! + ğ‘¦ğ‘¦! ) ğ‘¥ğ‘¥ âˆ’ ğ‘¥ğ‘¥! âˆ’
ğ‘¥ğ‘¥! âˆ’ ğ‘¥ğ‘¥! ğ‘¦ğ‘¦ + ğ‘¦ğ‘¦!

(1)
(2)

1878	

Sahar Z. Amir et al. / Procedia Computer Science 108C (2017) 1873â€“1882

Similarly for other possible cases by substituting the points by their equivalent symmetrical mirror.
In the vertical and horizontal shape fractures, ğ‘‘ğ‘‘!" indicates the distances considering both side of the
fracture; âˆ†ğ‘¥ğ‘¥! and âˆ†ğ‘¦ğ‘¦! for the first side; âˆ†ğ‘¥ğ‘¥! and âˆ†ğ‘¦ğ‘¦! for the second side.
RF-HEF fine scale computations depend on vertical distance ğ‘‘ğ‘‘! between fractures and the coarse
grid cell edges. In other words, the computations applied follow the steps: (1) randomly select points
ğ‘¥ğ‘¥-positions within the fracture ğ‘¥ğ‘¥ range; (2) use the slop (computed from the ğ‘¥ğ‘¥, ğ‘¦ğ‘¦ positions of the points
defining the fracture shape); (3) use the line equation: ğ‘¦ğ‘¦ âˆ’ ğ‘¦ğ‘¦! = ğ‘šğ‘š (ğ‘¥ğ‘¥ âˆ’ ğ‘¥ğ‘¥! ) to find the ğ‘¦ğ‘¦-positions of
the randomly selected ğ‘¥ğ‘¥-positions; finally, (4) apply the distance ğ‘‘ğ‘‘! equation according to the fracture
shapes and Table 2 rules or their mirrors as fits with the case under study.
Since successive grid cells form the continuum, each grid cell boundary conditions effects need to
be reduced. Oversampling technique is one of the methods used to reduce boundary conditions effects.
The basic concept for the oversampling technique is to add additional grid cells at each direction as
illustrated by Fig.1 and explained in Chen and Sun (2016).

2.2 Analysis results
In order to check adjacency between RF-DFN and RF-HEF flux exchange parameters, comparison
tests need to be applied over several examples. This paper analysis assumes a normalized grid cell
0: 1 Ã—[0: 1] in 2D and fractures pass through the points ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! = 0,0 and ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! = 1, ğ‘¦ğ‘¦ such
that ğ‘¦ğ‘¦ ranges between [0.45,0.95] by 0.05. Applying the oversampling technique, the normalized grid
cell 0: 1 Ã—[0: 1] became 0: 3 Ã—[0: 3] and so on for all the other test cases.
RF-HEF fine scale equations are applied to the new grid cell size 3Ã—3 and the fractures defined by
their ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! and ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! positions are also extended to the new grid cell edges as illustrated by Figs.
2-4 in RF-DFN. This oversampling effect can be applied on the RF-HEF model simply by substituting
â„ = 3ğ‘ğ‘ in ğ›¼ğ›¼ âˆ— equations from Table 2. This will compute the vertical distance ğ‘‘ğ‘‘! until the new cell
edges as illustrated in Amir and Sun (2016) derivations.
Resulting ğ›¼ğ›¼ âˆ— values in both RF-DFN and RF-HEF models show that: (1) As actual fractures slops
increase, ğ›¼ğ›¼ âˆ— values computed by both schemes become more and more adjacent to each other as
illustrated in Figs. 7-8. (2) Both schemes ğ›¼ğ›¼ âˆ— values are the closest for fractures with slop ğ‘šğ‘š between
[0.8: 1] and pass through the points ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! = 0,0 and ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! = 1, [0.8: 1] . (3) This applies to
the fractures perpendicular to them too according to the symmetrical conditions illustrated in Fig. 5.
(4) Scaling to fit into the normalized grid cell while preserving properties is one of the important
aspects that need to be applied. Ignoring this condition causes major additional variations between RFDFN and RF-HEF ğ›¼ğ›¼ âˆ— computations as illustrated by example in Figs. 9-10. In both figures, ğ›¼ğ›¼ âˆ—
computations are applied on the non-normalized grid cell 0.5: 1.5 Ã—[0: 1] instead of the normalized
grid cell 0: 1 Ã—[0: 1] by shifting ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! to 0.5,0 and the rest of the properties accordingly. The
behavior in Figs. 9-10 is similar to Figs.7-8 but with larger variances in values and no clear
intersection points between the two schemes results. (5) Similar tests can be applied for vertical and
horizontal fracture shapes intersecting with the grid cell edges.
Assuming a normalized grid cell 0: 1 Ã—[0: 1] with fractures passing through the points ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! =
ğ‘¥ğ‘¥, 0 and ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! = ğ‘¥ğ‘¥, 1 such that ğ‘¥ğ‘¥ ranges between [0.45,0.95] by 0.05. Elements and pressure
distribution using RF-DFN model for such case is illustrated by example in Fig. 3. RF-DFN and RFHEF ğ›¼ğ›¼ âˆ— comparison is illustrated by example in Figs. 11-12. Both figures show that ğ›¼ğ›¼ âˆ— values at
vertical fracture cases are very close to 8. RF-DFN ğ›¼ğ›¼ âˆ— = 8.155718 and RF-HEF ğ›¼ğ›¼ âˆ— = 8 causing
ğ·ğ·ğ·ğ·ğ·ğ· ğ›¼ğ›¼ âˆ— âˆ’ ğ»ğ»ğ»ğ»ğ»ğ»ğ›¼ğ›¼ âˆ— â‰ˆ 0.155718 as illustrated in Fig.12. Due to symmetrical properties, it can be
concluded that ğ›¼ğ›¼ âˆ— values at horizontal fracture cases are also very close to 8. This fits perfectly with
literature results based on Warren and Root (1963) DC models assuming vertical and horizontal
fractures. For anisotropic cases: ğ›¼ğ›¼ âˆ— = 4 (ğ‘˜ğ‘˜! âˆ†ğ‘¥ğ‘¥ ! + ğ‘˜ğ‘˜! âˆ†ğ‘¦ğ‘¦ ! + ğ‘˜ğ‘˜! âˆ†ğ‘§ğ‘§ ! ) and for isotropic cases:
ğ›¼ğ›¼ âˆ— = 4 1 âˆ†ğ‘¥ğ‘¥ ! + 1 âˆ†ğ‘¦ğ‘¦ ! + 1 âˆ†ğ‘§ğ‘§ ! (Kazemi, 1968; Lemonnier and Bourbiaux, 2010). The 2D
example assumptions application gives: ğ›¼ğ›¼ âˆ— = 4 1 1 ! + 1 1 ! = 8, similar to the test cases.

	

Sahar Z. Amir et al. / Procedia Computer Science 108C (2017) 1873â€“1882

Figure 7: RF-DFN and RF-HEF ğ›‚ğ›‚âˆ— values in the
normalized grid cell ğŸğŸ: ğŸğŸ Ã—[ğŸğŸ: ğŸğŸ] for triangle shape
fractures with slops range between [ğŸğŸ. ğŸ’ğŸ’ğŸ’ğŸ’, ğŸğŸ] by ğŸğŸ. ğŸğŸğŸğŸ.

Figure 8: the absolute difference between RF-DFN
and RF-HEF ğ›‚ğ›‚âˆ— values in the normalized grid cell
ğŸğŸ: ğŸğŸ Ã—[ğŸğŸ: ğŸğŸ] for fractures with slops range between
[ğŸğŸ. ğŸ’ğŸ’ğŸ’ğŸ’, ğŸğŸ] by ğŸğŸ. ğŸğŸğŸğŸ: ğ‘«ğ‘«ğ‘«ğ‘«ğ‘«ğ‘« ğœ¶ğœ¶âˆ— âˆ’ ğ‘¯ğ‘¯ğ‘¯ğ‘¯ğ‘¯ğ‘¯ğœ¶ğœ¶âˆ—

Figure 9: RF-DFN and RF-HEF ğ›‚ğ›‚âˆ— values in nonnormalized grid cell ğŸğŸ. ğŸ“ğŸ“: ğŸğŸ. ğŸ“ğŸ“ Ã—[ğŸğŸ: ğŸğŸ] for triangle
shape fractures with slops range between [ğŸğŸ. ğŸ’ğŸ’ğŸ’ğŸ’, ğŸğŸ] by
ğŸğŸ. ğŸğŸğŸğŸ.

Figure 10: the absolute difference between RFDFN and RF-HEF ğ›‚ğ›‚âˆ— values in the non-normalized
grid cell ğŸğŸ. ğŸ“ğŸ“: ğŸğŸ. ğŸ“ğŸ“ Ã—[ğŸğŸ: ğŸğŸ] for fractures with slops
range between [ğŸğŸ. ğŸ’ğŸ’ğŸ’ğŸ’, ğŸğŸ] by ğŸğŸ. ğŸğŸğŸğŸ : ğ‘«ğ‘«ğ‘«ğ‘«ğ‘«ğ‘« ğœ¶ğœ¶âˆ— âˆ’
ğ‘¯ğ‘¯ğ‘¯ğ‘¯ğ‘¯ğ‘¯ğœ¶ğœ¶âˆ—

Figure 11: RF-DFN and RF-HEF ğ›‚ğ›‚âˆ— values in the
normalized grid cell ğŸğŸ: ğŸğŸ Ã—[ğŸğŸ: ğŸğŸ] for vertical shape
fractures.

Figure 12: the absolute difference between RFDFN and RF-HEF ğ›‚ğ›‚âˆ— values in the normalized grid cell
ğŸğŸ: ğŸğŸ Ã—[ğŸğŸ: ğŸğŸ] for vertical fractures.

1879

Sahar Z. Amir et al. / Procedia Computer Science 108C (2017) 1873â€“1882

1880	

However, literature ğ›¼ğ›¼ âˆ— for the simplified vertical and horizontal fracture shapes doesnâ€™t apply to
other shapes effected by sizes, orientations, â€¦ etc. as illustrated in Figs.1-10.

3 Flow model generalization
From oil extraction point of view, reservoir fracking is applied during drilling wells forcing open
existing fissures with crush-resistant Frac sands. Such processes cause higher permeability fractures
compared to matrices, different porosities and other properties fitting rocks structures, â€¦ etc. A massmomentum conservation law is used according to the unified Hagen-Poiseuille-type equation to
preserve the physical properties for a single-phase single-component slightly compressible rock and
fluid. Component adsorption is considered within each rock section type according to its properties
(Civan et al., 2011):
(3)
ğœ•ğœ• ğœ•ğœ•ğœ•ğœ• ğœŒğœŒğœŒğœŒ + 1 âˆ’ ğœ‘ğœ‘ ğ‘ğ‘! + âˆ‡. ğœŒğœŒğ‘¢ğ‘¢! = ğ‘„ğ‘„!
Index ğ‘ğ‘ = ğ‘šğ‘š, ğ‘“ğ‘“ indicates matrices and fractures; ğ‘ğ‘! is the mass of a single-phase component adsorbed
per solid volume; ğœŒğœŒ density; ğœ‘ğœ‘ porosity; ğ‘¢ğ‘¢ velocity; ğ‘„ğ‘„! source term; ğ‘¡ğ‘¡ time. Expanding the first term:
ğœ•ğœ•ğ‘ğ‘!
ğœ•ğœ•ğœ•ğœ• ğœ•ğœ•ğ‘ğ‘!
ğœ•ğœ•ğœ•ğœ•
ğœ•ğœ•ğœ•ğœ•
(4)
ğœŒğœŒ
+ ğœ‘ğœ‘
+ 1 âˆ’ ğœ‘ğœ‘
âˆ’ ğ‘ğ‘!
+ âˆ‡. ğœŒğœŒğ‘¢ğ‘¢! = ğ‘„ğ‘„!
ğœ•ğœ•ğ‘ğ‘! ğœ•ğœ•ğœ•ğœ•
ğœ•ğœ•ğ‘ğ‘!
ğœ•ğœ•ğ‘ğ‘!
ğœ•ğœ•ğ‘ğ‘!
Adsorbed single-phase component per solid volume estimation methods include Langmuir isotherms
(1932), BET [after Burner, Emmett, and Teller] (Atkins, 1978), and molecular simulation (Sui et al.,
2015). For simplification purposes, we use Langmuir isotherm in this paper:
(5)
ğ‘ğ‘! = ğœŒğœŒ! ğ‘€ğ‘€! ğ‘‰ğ‘‰! ğ‘ğ‘!
ğ‘‰ğ‘‰!"# ğ‘ğ‘! + ğ‘ğ‘!
ğœŒğœŒ! is density (constant); ğ‘€ğ‘€! gas molecular weight (constant); ğ‘‰ğ‘‰!"# molar volume of gas at standard
temperature 273.15 ğ¾ğ¾ ! at pressure 101325 Pa (constant); ğ‘‰ğ‘‰! Langmuir volume; ğ‘ğ‘! Langmuir; ğ‘ğ‘!
considered rock section pressure such that ğ‘ğ‘ = ğ‘šğ‘š, ğ‘“ğ‘“.
(6)
ğœ•ğœ•ğ‘ğ‘! ğœ•ğœ•ğ‘ğ‘! = ğœŒğœŒ! ğ‘€ğ‘€! ğ‘‰ğ‘‰! ğ‘ğ‘!
ğ‘‰ğ‘‰!"# ğ‘ğ‘! + ğ‘ğ‘! !
Assuming slightly compressible fluid:
1 ğœ•ğœ•ğœ•ğœ•
1 ğœ•ğœ•ğœ•ğœ•
ğœ•ğœ•ğœ•ğœ•
(7)
ğ‘ğ‘! = âˆ’
=
â†’
= ğ‘ğ‘! ğœŒğœŒ
ğ‘‰ğ‘‰ ğœ•ğœ•ğ‘ğ‘! ! ğœŒğœŒ ğœ•ğœ•ğ‘ğ‘! !
ğœ•ğœ•ğ‘ğ‘!
Using Taylor series approximation for slightly compressible rocks and fluids:
(8)
ğœŒğœŒ = ğœŒğœŒ ! exp ğ‘ğ‘! ğ‘ğ‘! âˆ’ ğ‘ğ‘!! ; ğœ‘ğœ‘ = ğœ‘ğœ‘ ! exp ğ‘ğ‘! ğ‘ğ‘! âˆ’ ğ‘ğ‘!! ; ğœ•ğœ•ğœ•ğœ• ğœ•ğœ•ğ‘ğ‘! = ğœ‘ğœ‘! ğ‘ğ‘!
!
!
!
ğ‘ğ‘! is fluid compressibility; ğ‘ğ‘! is rock compressibility; ğœŒğœŒ is density at ğ‘ğ‘! pressure; ğœ‘ğœ‘ is porosity at ğ‘ğ‘!!
pressure. Substituting Eqs. 5-8 in Eq. 4:
ğœŒğœŒ! ğ‘€ğ‘€! ğ‘‰ğ‘‰! ğ‘ğ‘!
ğœŒğœŒ! ğ‘€ğ‘€! ğ‘‰ğ‘‰!
ğ‘ğ‘!
ğœ•ğœ•ğœ•ğœ•
(9)
ğœŒğœŒğœ‘ğœ‘! ğ‘ğ‘! + ğœ‘ğœ‘ğ‘ğ‘! ğœŒğœŒ + 1 âˆ’ ğœ‘ğœ‘
âˆ’
ğœ‘ğœ‘! ğ‘ğ‘!
+ âˆ‡. ğœŒğœŒğ‘¢ğ‘¢! = ğ‘„ğ‘„!
ğœ•ğœ•ğœ•ğœ•
ğ‘‰ğ‘‰!"#
ğ‘ğ‘! + ğ‘ğ‘! !
ğ‘‰ğ‘‰!"# ğ‘ğ‘! + ğ‘ğ‘!
!
!
(10)
ğ‘„ğ‘„! = ğ‘ğ‘! + ğ›¼ğ›¼ (ğ‘ğ‘! âˆ’ ğ‘ğ‘! ); ğ‘„ğ‘„! = ğ‘ğ‘! + ğ›¼ğ›¼ (ğ‘ğ‘! âˆ’ ğ‘ğ‘! ); Ignoring gravity effects:
!

!

ğ‘˜ğ‘˜!
ğ‘˜ğ‘˜! ğœ•ğœ•ğ‘ğ‘!
(11)
ğ‘¢ğ‘¢! = âˆ’
âˆ‡ğ‘ğ‘! â†’ ğ‘¢ğ‘¢!! = âˆ’
ğœ‡ğœ‡
ğœ‡ğœ‡ ğœ•ğœ•ğœ•ğœ•
ğ‘ğ‘! is total head (total amount of pressure for a system fluid flow); ğ‘ğ‘! = â„! + â„! ; â„! : vertical rise
(elevation head); â„! : friction loss (pressure head). ğœ‡ğœ‡ is viscosity assumed to be constant in this paper;
ğ‘˜ğ‘˜ is permeability; ğ‘¢ğ‘¢ ! is velocity in ğ‘¥ğ‘¥ âˆ’ axis and so on in all axisâ€™s.
According to Figs. 7-8, RF-DFN and RF-HEF ğ›¼ğ›¼ âˆ— are most adjacent in the normalized cells
0: 1 Ã—[0: 1] when fractures pass through the point ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! = ğ‘¥ğ‘¥, 0 with slop 0.9 for triangle shape
fractures. So, the reservoir in Fig. 13-14 is chosen to have 88Ã—88 grid cells and a fracture defined by
the equation ğ‘¦ğ‘¦ = 0.9ğ‘¥ğ‘¥ and two more fractures parallel to it: ğ‘¦ğ‘¦ = 0.9ğ‘¥ğ‘¥ + 5 and ğ‘¦ğ‘¦ = 0.9ğ‘¥ğ‘¥ âˆ’ 5. The flow
is applied for single-phase Ethane properties with the slip effects. Fig.13 visualizes the flow behavior
using velocity quivers and show that fluids have a tendency to flow into the fracture and then along

	

Sahar Z. Amir et al. / Procedia Computer Science 108C (2017) 1873â€“1882

the fracture in mediums with higher permeability fractures. Fig.14 gives an indication for the small
size fractures production rates.

Figure 13: coupling fine scale with coarse scale in
RF-HEF model for a fracture with equation ğ’šğ’š = ğŸğŸ. ğŸ—ğŸ—ğŸ—ğŸ—
and two fractures parallel to it.

Figure 14: matrices cumulative rate for the test
case described in Fig.13.

4 Conclusion
RF-DFN and RF-HEF ğ›¼ğ›¼ âˆ— for vertical and horizontal fractures are approximately equivalent to
Kazemi (1968) simplification for Warren and Root (1963) assumption. For more complex fracture
shapes, RF-DFN ğ›¼ğ›¼ âˆ— numerical solutions and RF-HEF fine-scale ğ›¼ğ›¼ âˆ— analytic solutions applying exactly
similar testing conditions are compared. As a result, it was found that the difference between ğ›¼ğ›¼ âˆ— values
in both schemes decreases as fractures slops increase within each grid cell. In the normalized grid cell
0: 1 Ã—[0: 1], these values are the nearest to each other when fractures slops range between the values
[0.8: 1] and passes through the points ğ‘¥ğ‘¥! , ğ‘¦ğ‘¦! = 0,0 for each fracture. The same could apply to the
fractures perpendicular to them due to the symmetrical properties applied.
A generalization was provided for Amir and Sun (2016) laboratory test shale gas model in order to
make it applicable to any slightly compressible single-phase fluid flow within fractured porous media.
Results showed that fluids have tendency to flow into the fracture and then along the fracture in
mediums with higher permeability fractures. Visualization of flow using velocity quivers is used to
detect and demonstrate the diverse flow regimes progressively occurring over time.

5 Future work
Since the difference between RF-DFN and RF-HEF ğ›¼ğ›¼ âˆ— values decreases as fracture slops increase,
it is adequate to assume that ğ›¼ğ›¼ âˆ— values could fit better if the angles formed between fractures and grid
cell edges were taken into account in the RF-HEF fine-scale analytic solution enhancement.

6 Acknowledgements
King Abdullah University of Science and Technology (KAUST) funding supported the research
reported in this publication.

1881

Sahar Z. Amir et al. / Procedia Computer Science 108C (2017) 1873â€“1882

1882	

References
Amir, S. and Sun, S. (2016). An Efficient Two-Scale Hybrid Embedded Fracture Model for Shale Gas
Simulation. Available: http://dx.doi.org/10.1016/j.petrol.2016.12.023.
Atkins, P.W. (1978). Physical Chemistry 2nd edition. San Francisco: W. H. Free-man and Company.
Chen, H. and Sun, S. (2016). A Two-Scale Reduced Model for Darcy Flow in Fractured Porous
Media. ICCS 2016. Vol. 80: 1324-1333.
Cipolla, C.L. Lolon, E.P. Erdle, J.C. Rubin, B. (2010). Reservoir Modeling in Shale-Gas Reservoirs.
SPE-125530-PA.
Civan, F. Rai, C. S.and Sondergeld, C. H. (2011). Shale-gas permeability and diffusivity inferred by
improved formulation of relevant retention and transport mechanisms. Transport in Porous Media,
vol. 86, no. 3, pp. 925â€“944.
Clarkson, C.R. Nobakht, M. Kaviani, D. and Ertekin, T. (2012). Production Analysis of Tight-Gas and
Shale-Gas Reservoirs Using the Dynamic-Slippage Concept. SPE Journal. March 2012: 230-242.
Jaffre, J. Martin, V. Roberts, J. (2006). Modeling fractures and barriers as interfaces for flow in
porous media. INRIA. 4848.
Kazemi, H. (1968). Pressure transient analysis of naturally fractured reservoirs with uniform fracture
distribution. Proceedings of 43rd Annual Fall Meeting, Houston, Tex, USA, September-October 1968.
Langmuir, I. (1932). Vapor Pressures, Evaporation, Condensation and Adsorption. J. Am. Chem.
Soc., 1932, 54 (7), pp 2798â€“2832.
Lee, S.H. Jensen, C.L. Lough, M.F. (2000). Efficient finite-difference model for flow in a reservoir
with multiple length-scale fractures. SPE J., 3 (5), pp. 268-275.
Lee, S.H. Lough, M.F. Jensen, C.L. (2001). Hierarchical modeling of flow in naturally fractured
formations with multiple length scales. Water Resources, Res, 37, pp. 443-455.
Lemonnier, P. and Bourbiaux, B. (2010). Simulation of Naturally Fractured Reservoirs: MatrixFracture Transfers and Typical Features of Numerical Studies. Oil & Gas Science and Technology â€“
Rev. IFP, Vol. 65, No. 2, pp. 263-286.
LeVeque, R.(2007). Finite Difference Methods for Ordinary and Partial Differential Equations. SIAM.
Li, L. and Lee, S.H. (2008). Efficient field-scale simulation of black oil in naturally fractured
reservoir through discrete fracture networks and homogenized media. SPE Reserv. 750â€“758.
Li, D. Zha, W. Zheng, D. Zhang, L. Lu, D. (2014). Effect of Matrix-Wellbore Flow and Porosity on
Pressure Transient Response in Shale Formulation Modeling by Dual Porosity and Dual Permeability
System. J. Chemistry. Vol. 2015. Article ID: 426860.
Schlumberger. (2013). Whole-Core CT Scanning from CoreFlow Services: Digital rock and fluid
analytics services for characterizing whole-core samples.
Sui, H. Yao, J. Zhang, L. (2015). Molecular Simulation of Shale Gas Adsorption and Diffusion in Clay
Nanopores. Computation 2015, vol.3 , p.687-700; doi:10.3390/computation3040687
Warren, J. E. and Root, P. J. (1963). The behavior of naturally fractured reservoirs. SOC. Petrol. Eng.
J., 3, 245-255.
Weber, K. J. (1986). How heterogeneity affects oil recovery. Reservoir Characterization: Orlando, FL,
Academy Press, p. 487â€“544.
Zhang, X. Du, C. Deimbacher, F. Crick, M. Harikesavanallur, A. (2009). Sensitivity Studies of
Horizontal Wells with Hydraulic Fractures in Shale Gas Reservoirs. International Petroleum
Technology Conference. IPTC 13338.

